# LOAD LIBRARIES

``` r
library(reshape2) # melt(); citation("reshape2")
library(dplyr)    # %>%;    citation("dplyr")
library(plyr)     # ddply;  citation("plyr") # must be loaded after dplyr
library(rlang)

library(pander)   # pandoc.table
```

# DEFINE FUNCTIONS

## Standard error

The `se()` function is used to calculate the `standard error` of the
mean. `x` represents a numeric vector containing replicates of a given
measurement. The `na.rm = TRUE` argument indicates that by default this
function ignores missing values.

``` r
# x:  numeric

se <- function(x, ...) {
  sd(x, ...) / sqrt(length(x))
}
```

``` r
se(c(0.647603, 0.547048, 0.529873, NA, 0.908040, 0.835195))
```

    ## [1] NA

``` r
se(c(0.647603, 0.547048, 0.529873, NA, 0.908040, 0.835195), na.rm = TRUE)
```

    ## [1] 0.06965193

## Gaussian error propagation

The following function is based on article published on January 22, 2015
by Lee Pang in the R bloggers website
(<https://www.r-bloggers.com/easy-error-propagation-in-r/>). It allows
convenient integration with libraries of the tidyverse and the dplyr
grammar. It builds on the mutate() function to apply the chain rule on
any given mathematical formula.

To illustrate its working let’s assume one needs to propagate the error
on the following *Z* calculation:

The Gaussian propagated error *d**Z* can be calculated by applying the
chain-rule to *Z*, as follows:

The `mutate_with_error()` receives any given formula, construct the
respective formula for error propagation and returns the results of both
calculations. For this two arguments must be input to the
`mutate_with_error()` function. First, the `.data` argument receives a
`data.frame` containing the mean values to be used in the calculation
(i.e. *X* and *Y* in the example above) plus the standard error of these
means (i.e. *d**X* and *d**Y*) as individual columns. This nomenclature
is important: all columns containing standard errors must be named with
*d* appended to its respective mean values column. Then `f` receives a
`formula` object indicating the calculation to be done. *Vide* below for
more details on the structure of the datasets.

Inside the `mutate_with_error()` function we have the `exprs` object
which is a list of the two calculations to be done - the value of
interest and the propagated error. First, the `deparse(f[[3]])` command
transform the right-hand side of the formula `f` into a `character`
string. Then, a new `character` string is constructed containing the
full right-hand side of the formula that will be used to calculated the
propagated error (*vide* below). Finally, the left-hand side of the new
error propagation formula is created by appending the character *d* to
the original formula left-hand side (i.e. *Z* becomes *d**Z*). The
`mutate_with_error()` run these commands and return the results of the
calculation defined by the formula and its associated propagated error
appended to `.data`.

``` r
# .data: data.frame
#     f: formula
mutate_with_error = function(.data, f) {
  require(dplyr)
  
  exprs = list(
    # expression to compute new variable values
    deparse(f[[3]]),
    
    # expression to compute new variable errors
    sapply(all.vars(f[[3]]), function(v) {
      dfdp = deparse(D(f[[3]], v))
      sprintf('(d%s*(%s))^2', v, dfdp)
    }) %>%
      paste(collapse='+') %>%
      sprintf('sqrt(%s)', .)
  )
  
  names(exprs) = c(
    deparse(f[[2]]),                 # unchanged names
    sprintf('d%s', deparse(f[[2]]))  # 'd' appended to the names
  )
  
  # MATHEMAGICS!
  .data[names(exprs)] <- lapply(exprs , function(x) { eval(parse(text= x), envir = .data) })
  #.data %>% mutate_(.dots=exprs) #### -> mutate_() is deprecated, figure out how to fix.
  
  .data
}
```

``` r
data.frame(X = c(0.647, 0.547, 0.529, 0.908, 0.835), Y = c(1.072, 0.905, 0.877, 1.503, 1.383)) %>%
  summarise(dX = se(X), dY = se(Y), X = mean(X), Y = mean(Y)) %>%
  mutate_with_error(Z ~ (X-Y)/(X+Y)^2) %>%
  select(X, dX, Y, dY, Z, dZ) %>%
  pandoc.table()
```

|   X    |   dX    |   Y   |   dY   |    Z    |   dZ    |
|:------:|:-------:|:-----:|:------:|:-------:|:-------:|
| 0.6932 | 0.07639 | 1.148 | 0.1264 | -0.1342 | 0.03859 |

# LOAD DATA

The sections below demonstrates the procedure for calculating
*K*<sub>*s*</sub>, *K*<sub>*d*</sub> and *R**G**R*<sup>*S**T**R*</sup>
using data from Ishihara et al., 2017.

Datasets from the original publication are available online at \[LINK\].
Datasets are expected to contain replicate measurements as rows,
metadata information and measurement values as columns. Data from
Ishihara et al., 2017 is composed by replicate measurements from three
independent experiments (`Exp`) done in various genotypes (`Genotype`)
at different time points (`time`). It contains measurements of 13C
labelling alanine and serine enrichments in proteins (`Prot_Ala` and
`Prot_Ser`) and in free amino acids (`Free_Ala` and `Free_Ser`) plus
glucose enrichment in cell walls (`Glc`). \[NEED TO CHECK THE TEXT
ITSELF, PHRASE BETTER\]

-   All missing values should be set as `NA` in your original table
-   `CSV` files are a convenient way of loading data to R.

``` r
ishihara2017_data <- read.csv2("data/KDKSRGR_13C.enrichment[3].csv")

# check data structure
str(ishihara2017_data)
```

    ## 'data.frame':    117 obs. of  8 variables:
    ##  $ Genotype: chr  "Ang0" "Bsch2" "Bu2" "Col0" ...
    ##  $ Exp     : chr  "Exp1" "Exp1" "Exp1" "Exp1" ...
    ##  $ time    : int  0 0 0 0 0 0 0 0 0 0 ...
    ##  $ Prot_Ala: num  0.00827 0.00999 0 0.01054 0 ...
    ##  $ Prot_Ser: num  0.01137 0.01236 0.00932 0.01314 0 ...
    ##  $ Free_Ala: num  0.0126 0.0129 0.0119 0.0114 0.0164 ...
    ##  $ Free_Ser: num  0.00757 0.00637 0.00664 0.00782 0.01192 ...
    ##  $ Glc     : num  0.0361 0.0422 0.0343 0.0363 0.0344 ...

# PREPARE DATA

There are many different ways in which R can prepare datasets.
Nevertheless, the important bits are: the data must be summarised -
i.e. the mean and standard error of the mean should be used below which
must be placed in individual columns with names as indicated above.

``` r
vars_prot <- c("Prot_Ala", "Prot_Ser")
vars_free <- c("Free_Ala", "Free_Ser")
vars_glc  <- c("Glc")
vars_id   <- c("Genotype", "time")

ishihara2017_summary <- ishihara2017_data %>%
  #ddply(.(Genotype, time), function(each.data) {
  ddply(as.quoted(vars_id), function(each.data) {
    ldply(c(vars_prot, vars_free, vars_glc), function(each_var) {
      rbind(
        data.frame(variable = each_var,              value = mean(each.data[,each_var], na.rm = T)),
        data.frame(variable = paste0("d", each_var), value =   se(each.data[,each_var], na.rm = T))
      )
    })
  }) %>%
  #dcast(Genotype + time ~ variable)
  dcast(paste(paste(vars_id, collapse = " + "), "variable", sep = " ~ "))
```

``` r
ishihara2017_summary
```

<div data-pagedtable="false">

<script data-pagedtable-source type="application/json">
{"columns":[{"label":["Genotype"],"name":[1],"type":["chr"],"align":["left"]},{"label":["time"],"name":[2],"type":["int"],"align":["right"]},{"label":["dFree_Ala"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["dFree_Ser"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["dGlc"],"name":[5],"type":["dbl"],"align":["right"]},{"label":["dProt_Ala"],"name":[6],"type":["dbl"],"align":["right"]},{"label":["dProt_Ser"],"name":[7],"type":["dbl"],"align":["right"]},{"label":["Free_Ala"],"name":[8],"type":["dbl"],"align":["right"]},{"label":["Free_Ser"],"name":[9],"type":["dbl"],"align":["right"]},{"label":["Glc"],"name":[10],"type":["dbl"],"align":["right"]},{"label":["Prot_Ala"],"name":[11],"type":["dbl"],"align":["right"]},{"label":["Prot_Ser"],"name":[12],"type":["dbl"],"align":["right"]}],"data":[{"1":"Ang0","2":"0","3":"0.002126824","4":"0.001426218","5":"0.005299616","6":"0.0033745404","7":"0.0017214871","8":"0.009462740","9":"0.004770930","10":"0.03205400","11":"0.013619043","12":"0.009270087"},{"1":"Ang0","2":"24","3":"0.010482933","4":"0.011058050","5":"0.023225245","6":"0.0116518145","7":"0.0044318631","8":"0.809272000","9":"0.827578500","10":"0.26363900","11":"0.237449500","12":"0.231696667"},{"1":"Ang0","2":"120","3":"0.004990727","4":"0.004530858","5":"0.009765074","6":"0.0136208625","7":"0.0080657412","8":"0.017954339","9":"0.024166732","10":"0.10863353","11":"0.081274667","12":"0.081134333"},{"1":"Bsch2","2":"0","3":"0.002695762","4":"0.001333393","5":"0.005818499","6":"0.0030307979","7":"0.0033503683","8":"0.007784377","9":"0.003791980","10":"0.03397107","11":"0.010103613","12":"0.006760957"},{"1":"Bsch2","2":"24","3":"0.020441530","4":"0.017225799","5":"0.013203935","6":"0.0087351405","7":"0.0056304478","8":"0.889082898","9":"0.876193727","10":"0.27896667","11":"0.218777667","12":"0.205488333"},{"1":"Bsch2","2":"120","3":"0.002869262","4":"0.004681336","5":"0.004073121","6":"0.0085570543","7":"0.0024922948","8":"0.015018215","9":"0.018525244","10":"0.10341253","11":"0.075213667","12":"0.070526667"},{"1":"Bu2","2":"0","3":"0.002325720","4":"0.001356079","5":"0.003681750","6":"0.0064764765","7":"0.0008735688","8":"0.007409200","9":"0.003936590","10":"0.02914440","11":"0.012865933","12":"0.009391077"},{"1":"Bu2","2":"24","3":"0.031477344","4":"0.016717538","5":"0.020633051","6":"0.0094415111","7":"0.0046942183","8":"0.823436794","9":"0.832925030","10":"0.25937533","11":"0.223082000","12":"0.210570333"},{"1":"Bu2","2":"120","3":"0.003441396","4":"0.003929320","5":"0.005101506","6":"0.0063998949","7":"0.0025022574","8":"0.015578244","9":"0.018081609","10":"0.09769370","11":"0.084831000","12":"0.076720333"},{"1":"Col0","2":"0","3":"0.001126388","4":"0.002281206","5":"0.004827112","6":"0.0041353248","7":"0.0016434416","8":"0.009273507","9":"0.003588647","10":"0.03755323","11":"0.008070567","12":"0.010000263"},{"1":"Col0","2":"24","3":"0.010604461","4":"0.006752922","5":"0.017060436","6":"0.0152194339","7":"0.0040678176","8":"0.816377776","9":"0.805453353","10":"0.25421767","11":"0.210373333","12":"0.214677000"},{"1":"Col0","2":"120","3":"0.002925453","4":"0.004045988","5":"0.006412159","6":"0.0048597779","7":"0.0020369607","8":"0.015120744","9":"0.017912886","10":"0.10078663","11":"0.085321333","12":"0.078208333"},{"1":"Cvi","2":"0","3":"0.003833341","4":"0.002722050","5":"0.003533195","6":"0.0057559466","7":"0.0012569448","8":"0.008932330","9":"0.006480517","10":"0.03227132","11":"0.011169167","12":"0.001799510"},{"1":"Cvi","2":"24","3":"0.042450229","4":"0.040193648","5":"0.018591130","6":"0.0098312887","7":"0.0047906729","8":"0.784071272","9":"0.792170861","10":"0.24606667","11":"0.219929333","12":"0.212418667"},{"1":"Cvi","2":"120","3":"0.001827630","4":"0.006964248","5":"0.006617909","6":"0.0029895713","7":"0.0020182625","8":"0.018516702","9":"0.023875932","10":"0.10506427","11":"0.085877667","12":"0.077525667"},{"1":"Da0","2":"0","3":"0.003171368","4":"0.002753668","5":"0.006598357","6":"0.0032103964","7":"0.0010666681","8":"0.007302007","9":"0.003269073","10":"0.03302507","11":"0.017047567","12":"0.011475593"},{"1":"Da0","2":"24","3":"0.024897371","4":"0.049629908","5":"0.019503083","6":"0.0050980360","7":"0.0011948206","8":"0.882129788","9":"0.838618210","10":"0.26215067","11":"0.237543333","12":"0.224537000"},{"1":"Da0","2":"120","3":"0.002575688","4":"0.004514705","5":"0.006714886","6":"0.0012310763","7":"0.0020256206","8":"0.017749334","9":"0.021587890","10":"0.10420687","11":"0.085773667","12":"0.077024000"},{"1":"Ei2","2":"0","3":"0.002226488","4":"0.002516555","5":"0.004966955","6":"0.0042021701","7":"0.0026342749","8":"0.009970023","9":"0.006907917","10":"0.03180587","11":"0.012837857","12":"0.009345617"},{"1":"Ei2","2":"24","3":"0.027185309","4":"0.018454254","5":"0.030211849","6":"0.0204169053","7":"0.0090426647","8":"0.860935151","9":"0.876675816","10":"0.25619167","11":"0.193283500","12":"0.206985667"},{"1":"Ei2","2":"120","3":"0.003214255","4":"0.004015927","5":"0.005127667","6":"0.0025310959","7":"0.0048448822","8":"0.014765420","9":"0.019470800","10":"0.10285327","11":"0.080548000","12":"0.074736333"},{"1":"Kl0","2":"0","3":"0.001976794","4":"0.002125056","5":"0.005806594","6":"0.0045807005","7":"0.0038898616","8":"0.008030447","9":"0.003790420","10":"0.03369093","11":"0.008917267","12":"0.007611145"},{"1":"Kl0","2":"24","3":"0.031191870","4":"0.018088349","5":"0.023789804","6":"0.0114923918","7":"0.0073066272","8":"0.882906308","9":"0.858261056","10":"0.25499267","11":"0.231587000","12":"0.219598333"},{"1":"Kl0","2":"120","3":"0.003588624","4":"0.004287024","5":"0.008522737","6":"0.0052151349","7":"0.0004797521","8":"0.016530602","9":"0.020687847","10":"0.09676523","11":"0.088797000","12":"0.079679333"},{"1":"Lip0","2":"0","3":"0.002705954","4":"0.001362854","5":"0.006842885","6":"0.0000000000","7":"0.0021325129","8":"0.008474723","9":"0.004557383","10":"0.03359007","11":"0.000000000","12":"0.002858457"},{"1":"Lip0","2":"24","3":"0.030517257","4":"0.015832671","5":"0.020653010","6":"0.0078847772","7":"0.0010644312","8":"0.839407206","9":"0.851032332","10":"0.25848367","11":"0.234341667","12":"0.225393667"},{"1":"Lip0","2":"120","3":"0.004025762","4":"0.002924188","5":"0.005823850","6":"0.0098269446","7":"0.0063470362","8":"0.017126584","9":"0.022093400","10":"0.10204487","11":"0.065762500","12":"0.073185500"},{"1":"Mh1","2":"0","3":"0.002702706","4":"0.002733441","5":"0.004325808","6":"0.0026998943","7":"0.0020504533","8":"0.009096723","9":"0.003765343","10":"0.03049023","11":"0.014580200","12":"0.009898377"},{"1":"Mh1","2":"24","3":"0.013062356","4":"0.009836593","5":"0.019834237","6":"0.0030704139","7":"0.0018631249","8":"0.876109860","9":"0.861161430","10":"0.26524000","11":"0.234206667","12":"0.219176000"},{"1":"Mh1","2":"120","3":"0.002834276","4":"0.003546673","5":"0.001459910","6":"0.0006541767","7":"0.0025700763","8":"0.015991158","9":"0.019371099","10":"0.10004657","11":"0.090089333","12":"0.083200000"},{"1":"Old1","2":"0","3":"0.002032038","4":"0.002493667","5":"0.006423412","6":"0.0050022496","7":"0.0039058189","8":"0.009465063","9":"0.004966187","10":"0.03385850","11":"0.009582200","12":"0.006155984"},{"1":"Old1","2":"24","3":"0.011288860","4":"0.014742924","5":"0.023382317","6":"0.0147980808","7":"0.0040170839","8":"0.873616444","9":"0.867452540","10":"0.28691967","11":"0.212230333","12":"0.216322333"},{"1":"Old1","2":"120","3":"0.002482685","4":"0.006172341","5":"0.007784956","6":"0.0012508408","7":"0.0043583597","8":"0.017186947","9":"0.015829843","10":"0.09951567","11":"0.088623667","12":"0.080974000"},{"1":"Peter","2":"0","3":"0.002403649","4":"0.001828871","5":"0.005188284","6":"0.0035353990","7":"0.0031388755","8":"0.009176127","9":"0.004794867","10":"0.03613338","11":"0.006787780","12":"0.005484283"},{"1":"Peter","2":"24","3":"0.018514841","4":"0.018955672","5":"0.019105303","6":"0.0040153004","7":"0.0002598348","8":"0.911103611","9":"0.868935825","10":"0.25316267","11":"0.238156333","12":"0.225460333"},{"1":"Peter","2":"120","3":"0.002721006","4":"0.004071200","5":"0.007016288","6":"0.0091971244","7":"0.0077339376","8":"0.017237502","9":"0.019414792","10":"0.10504147","11":"0.085474000","12":"0.079448000"},{"1":"RRS7","2":"0","3":"0.002678887","4":"0.001918678","5":"0.004765221","6":"0.0044662061","7":"0.0031028942","8":"0.008115327","9":"0.005356247","10":"0.03131897","11":"0.008530867","12":"0.007539757"},{"1":"RRS7","2":"24","3":"0.020941840","4":"0.017388048","5":"0.028249340","6":"0.0156251319","7":"0.0105780023","8":"0.873036152","9":"0.880604385","10":"0.27391567","11":"0.211873333","12":"0.218347000"},{"1":"RRS7","2":"120","3":"0.004531040","4":"0.004021764","5":"0.005897806","6":"0.0063323256","7":"0.0056974212","8":"0.015134053","9":"0.018771557","10":"0.10538043","11":"0.084228667","12":"0.081903667"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>

</div>

<div data-pagedtable="false">

<script data-pagedtable-source type="application/json">
{"columns":[{"label":["Genotype"],"name":[1],"type":["chr"],"align":["left"]},{"label":["time"],"name":[2],"type":["int"],"align":["right"]},{"label":["dFree_Ala"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["dFree_Ser"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["dGlc"],"name":[5],"type":["dbl"],"align":["right"]},{"label":["dProt_Ala"],"name":[6],"type":["dbl"],"align":["right"]},{"label":["dProt_Ser"],"name":[7],"type":["dbl"],"align":["right"]},{"label":["Free_Ala"],"name":[8],"type":["dbl"],"align":["right"]},{"label":["Free_Ser"],"name":[9],"type":["dbl"],"align":["right"]},{"label":["Glc"],"name":[10],"type":["dbl"],"align":["right"]},{"label":["Prot_Ala"],"name":[11],"type":["dbl"],"align":["right"]},{"label":["Prot_Ser"],"name":[12],"type":["dbl"],"align":["right"]}],"data":[{"1":"Ang0","2":"0","3":"0.002126824","4":"0.001426218","5":"0.005299616","6":"0.0033745404","7":"0.0017214871","8":"0.009462740","9":"0.004770930","10":"0.03205400","11":"0.013619043","12":"0.009270087"},{"1":"Ang0","2":"24","3":"0.010482933","4":"0.011058050","5":"0.023225245","6":"0.0116518145","7":"0.0044318631","8":"0.809272000","9":"0.827578500","10":"0.26363900","11":"0.237449500","12":"0.231696667"},{"1":"Ang0","2":"120","3":"0.004990727","4":"0.004530858","5":"0.009765074","6":"0.0136208625","7":"0.0080657412","8":"0.017954339","9":"0.024166732","10":"0.10863353","11":"0.081274667","12":"0.081134333"},{"1":"Bsch2","2":"0","3":"0.002695762","4":"0.001333393","5":"0.005818499","6":"0.0030307979","7":"0.0033503683","8":"0.007784377","9":"0.003791980","10":"0.03397107","11":"0.010103613","12":"0.006760957"},{"1":"Bsch2","2":"24","3":"0.020441530","4":"0.017225799","5":"0.013203935","6":"0.0087351405","7":"0.0056304478","8":"0.889082898","9":"0.876193727","10":"0.27896667","11":"0.218777667","12":"0.205488333"},{"1":"Bsch2","2":"120","3":"0.002869262","4":"0.004681336","5":"0.004073121","6":"0.0085570543","7":"0.0024922948","8":"0.015018215","9":"0.018525244","10":"0.10341253","11":"0.075213667","12":"0.070526667"},{"1":"Bu2","2":"0","3":"0.002325720","4":"0.001356079","5":"0.003681750","6":"0.0064764765","7":"0.0008735688","8":"0.007409200","9":"0.003936590","10":"0.02914440","11":"0.012865933","12":"0.009391077"},{"1":"Bu2","2":"24","3":"0.031477344","4":"0.016717538","5":"0.020633051","6":"0.0094415111","7":"0.0046942183","8":"0.823436794","9":"0.832925030","10":"0.25937533","11":"0.223082000","12":"0.210570333"},{"1":"Bu2","2":"120","3":"0.003441396","4":"0.003929320","5":"0.005101506","6":"0.0063998949","7":"0.0025022574","8":"0.015578244","9":"0.018081609","10":"0.09769370","11":"0.084831000","12":"0.076720333"},{"1":"Col0","2":"0","3":"0.001126388","4":"0.002281206","5":"0.004827112","6":"0.0041353248","7":"0.0016434416","8":"0.009273507","9":"0.003588647","10":"0.03755323","11":"0.008070567","12":"0.010000263"},{"1":"Col0","2":"24","3":"0.010604461","4":"0.006752922","5":"0.017060436","6":"0.0152194339","7":"0.0040678176","8":"0.816377776","9":"0.805453353","10":"0.25421767","11":"0.210373333","12":"0.214677000"},{"1":"Col0","2":"120","3":"0.002925453","4":"0.004045988","5":"0.006412159","6":"0.0048597779","7":"0.0020369607","8":"0.015120744","9":"0.017912886","10":"0.10078663","11":"0.085321333","12":"0.078208333"},{"1":"Cvi","2":"0","3":"0.003833341","4":"0.002722050","5":"0.003533195","6":"0.0057559466","7":"0.0012569448","8":"0.008932330","9":"0.006480517","10":"0.03227132","11":"0.011169167","12":"0.001799510"},{"1":"Cvi","2":"24","3":"0.042450229","4":"0.040193648","5":"0.018591130","6":"0.0098312887","7":"0.0047906729","8":"0.784071272","9":"0.792170861","10":"0.24606667","11":"0.219929333","12":"0.212418667"},{"1":"Cvi","2":"120","3":"0.001827630","4":"0.006964248","5":"0.006617909","6":"0.0029895713","7":"0.0020182625","8":"0.018516702","9":"0.023875932","10":"0.10506427","11":"0.085877667","12":"0.077525667"},{"1":"Da0","2":"0","3":"0.003171368","4":"0.002753668","5":"0.006598357","6":"0.0032103964","7":"0.0010666681","8":"0.007302007","9":"0.003269073","10":"0.03302507","11":"0.017047567","12":"0.011475593"},{"1":"Da0","2":"24","3":"0.024897371","4":"0.049629908","5":"0.019503083","6":"0.0050980360","7":"0.0011948206","8":"0.882129788","9":"0.838618210","10":"0.26215067","11":"0.237543333","12":"0.224537000"},{"1":"Da0","2":"120","3":"0.002575688","4":"0.004514705","5":"0.006714886","6":"0.0012310763","7":"0.0020256206","8":"0.017749334","9":"0.021587890","10":"0.10420687","11":"0.085773667","12":"0.077024000"},{"1":"Ei2","2":"0","3":"0.002226488","4":"0.002516555","5":"0.004966955","6":"0.0042021701","7":"0.0026342749","8":"0.009970023","9":"0.006907917","10":"0.03180587","11":"0.012837857","12":"0.009345617"},{"1":"Ei2","2":"24","3":"0.027185309","4":"0.018454254","5":"0.030211849","6":"0.0204169053","7":"0.0090426647","8":"0.860935151","9":"0.876675816","10":"0.25619167","11":"0.193283500","12":"0.206985667"},{"1":"Ei2","2":"120","3":"0.003214255","4":"0.004015927","5":"0.005127667","6":"0.0025310959","7":"0.0048448822","8":"0.014765420","9":"0.019470800","10":"0.10285327","11":"0.080548000","12":"0.074736333"},{"1":"Kl0","2":"0","3":"0.001976794","4":"0.002125056","5":"0.005806594","6":"0.0045807005","7":"0.0038898616","8":"0.008030447","9":"0.003790420","10":"0.03369093","11":"0.008917267","12":"0.007611145"},{"1":"Kl0","2":"24","3":"0.031191870","4":"0.018088349","5":"0.023789804","6":"0.0114923918","7":"0.0073066272","8":"0.882906308","9":"0.858261056","10":"0.25499267","11":"0.231587000","12":"0.219598333"},{"1":"Kl0","2":"120","3":"0.003588624","4":"0.004287024","5":"0.008522737","6":"0.0052151349","7":"0.0004797521","8":"0.016530602","9":"0.020687847","10":"0.09676523","11":"0.088797000","12":"0.079679333"},{"1":"Lip0","2":"0","3":"0.002705954","4":"0.001362854","5":"0.006842885","6":"0.0000000000","7":"0.0021325129","8":"0.008474723","9":"0.004557383","10":"0.03359007","11":"0.000000000","12":"0.002858457"},{"1":"Lip0","2":"24","3":"0.030517257","4":"0.015832671","5":"0.020653010","6":"0.0078847772","7":"0.0010644312","8":"0.839407206","9":"0.851032332","10":"0.25848367","11":"0.234341667","12":"0.225393667"},{"1":"Lip0","2":"120","3":"0.004025762","4":"0.002924188","5":"0.005823850","6":"0.0098269446","7":"0.0063470362","8":"0.017126584","9":"0.022093400","10":"0.10204487","11":"0.065762500","12":"0.073185500"},{"1":"Mh1","2":"0","3":"0.002702706","4":"0.002733441","5":"0.004325808","6":"0.0026998943","7":"0.0020504533","8":"0.009096723","9":"0.003765343","10":"0.03049023","11":"0.014580200","12":"0.009898377"},{"1":"Mh1","2":"24","3":"0.013062356","4":"0.009836593","5":"0.019834237","6":"0.0030704139","7":"0.0018631249","8":"0.876109860","9":"0.861161430","10":"0.26524000","11":"0.234206667","12":"0.219176000"},{"1":"Mh1","2":"120","3":"0.002834276","4":"0.003546673","5":"0.001459910","6":"0.0006541767","7":"0.0025700763","8":"0.015991158","9":"0.019371099","10":"0.10004657","11":"0.090089333","12":"0.083200000"},{"1":"Old1","2":"0","3":"0.002032038","4":"0.002493667","5":"0.006423412","6":"0.0050022496","7":"0.0039058189","8":"0.009465063","9":"0.004966187","10":"0.03385850","11":"0.009582200","12":"0.006155984"},{"1":"Old1","2":"24","3":"0.011288860","4":"0.014742924","5":"0.023382317","6":"0.0147980808","7":"0.0040170839","8":"0.873616444","9":"0.867452540","10":"0.28691967","11":"0.212230333","12":"0.216322333"},{"1":"Old1","2":"120","3":"0.002482685","4":"0.006172341","5":"0.007784956","6":"0.0012508408","7":"0.0043583597","8":"0.017186947","9":"0.015829843","10":"0.09951567","11":"0.088623667","12":"0.080974000"},{"1":"Peter","2":"0","3":"0.002403649","4":"0.001828871","5":"0.005188284","6":"0.0035353990","7":"0.0031388755","8":"0.009176127","9":"0.004794867","10":"0.03613338","11":"0.006787780","12":"0.005484283"},{"1":"Peter","2":"24","3":"0.018514841","4":"0.018955672","5":"0.019105303","6":"0.0040153004","7":"0.0002598348","8":"0.911103611","9":"0.868935825","10":"0.25316267","11":"0.238156333","12":"0.225460333"},{"1":"Peter","2":"120","3":"0.002721006","4":"0.004071200","5":"0.007016288","6":"0.0091971244","7":"0.0077339376","8":"0.017237502","9":"0.019414792","10":"0.10504147","11":"0.085474000","12":"0.079448000"},{"1":"RRS7","2":"0","3":"0.002678887","4":"0.001918678","5":"0.004765221","6":"0.0044662061","7":"0.0031028942","8":"0.008115327","9":"0.005356247","10":"0.03131897","11":"0.008530867","12":"0.007539757"},{"1":"RRS7","2":"24","3":"0.020941840","4":"0.017388048","5":"0.028249340","6":"0.0156251319","7":"0.0105780023","8":"0.873036152","9":"0.880604385","10":"0.27391567","11":"0.211873333","12":"0.218347000"},{"1":"RRS7","2":"120","3":"0.004531040","4":"0.004021764","5":"0.005897806","6":"0.0063323256","7":"0.0056974212","8":"0.015134053","9":"0.018771557","10":"0.10538043","11":"0.084228667","12":"0.081903667"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>

</div>

# PULSE EXPERIMENTS

## Estimation of KS

We calculate the average enrichment of free labelled alanine and serine
at ZT24 and then the *K*<sub>*S*</sub> - using Gaussian error
propagation (REF). Data table is cast back into wide format prior to
calculations.

``` r
ishihara_KS <- ishihara2017_summary %>%
  subset(time == 24) %>%
  mutate_with_error( SAt1t2 ~ (Free_Ala + Free_Ser) / 2 ) %>%  # calculate the correction factor
  mutate_with_error( KS_Ala ~ (Prot_Ala / SAt1t2) ) %>%        # calculate KS for Alanine
  mutate_with_error( KS_Ser ~ (Prot_Ser / SAt1t2) ) %>%        # calculate KS for Serine
  select(
    -all_of(c( # remove unwanted columns
      "time",
      c(vars_prot, vars_free, vars_glc, "SAt1t2"),
      paste0("d", c(vars_prot, vars_free, vars_glc, "SAt1t2"))
    ))
  )

ishihara_KS
```

<div data-pagedtable="false">

<script data-pagedtable-source type="application/json">
{"columns":[{"label":[""],"name":["_rn_"],"type":[""],"align":["left"]},{"label":["Genotype"],"name":[1],"type":["chr"],"align":["left"]},{"label":["KS_Ala"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["dKS_Ala"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["KS_Ser"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["dKS_Ser"],"name":[5],"type":["dbl"],"align":["right"]}],"data":[{"1":"Ang0","2":"0.2901297","3":"0.014490779","4":"0.2831006","5":"0.006022329","_rn_":"2"},{"1":"Bsch2","2":"0.2478679","3":"0.010584508","4":"0.2328115","5":"0.007288489","_rn_":"5"},{"1":"Bu2","2":"0.2693639","3":"0.012789129","4":"0.2542564","5":"0.007877798","_rn_":"8"},{"1":"Col0","2":"0.2594269","3":"0.018875643","4":"0.2647341","5":"0.005419860","_rn_":"11"},{"1":"Cvi","2":"0.2790553","3":"0.016208761","4":"0.2695254","5":"0.011699278","_rn_":"14"},{"1":"Da0","2":"0.2760931","3":"0.010699489","4":"0.2609760","5":"0.008534873","_rn_":"17"},{"1":"Ei2","2":"0.2224704","3":"0.023873538","4":"0.2382417","5":"0.011341294","_rn_":"20"},{"1":"Kl0","2":"0.2660135","3":"0.014304106","4":"0.2522426","5":"0.009885593","_rn_":"23"},{"1":"Lip0","2":"0.2772553","3":"0.010900453","4":"0.2666687","5":"0.005567759","_rn_":"26"},{"1":"Mh1","2":"0.2696259","3":"0.004351441","4":"0.2523221","5":"0.003200148","_rn_":"29"},{"1":"Old1","2":"0.2437931","3":"0.017196542","4":"0.2484937","5":"0.005321389","_rn_":"32"},{"1":"Peter","2":"0.2675855","3":"0.006018278","4":"0.2533206","5":"0.003782189","_rn_":"35"},{"1":"RRS7","2":"0.2416383","3":"0.018210647","4":"0.2490214","5":"0.012668126","_rn_":"38"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>

</div>

## Estimation of RGRSTR

Cases in which calculations involve comparisons between time points
demands reorganization of the data set we are using. Below we define a
logic to create a individual column for values of each time point. This
will be achieved by melting the original data set, renaming the variable
names (i.e. append the time to their names) and finally re-casting the
tidy data set into a wide data set; as follows:

``` r
ishihara_pulse_data <- ishihara2017_summary %>%
  subset(time %in% c(0, 24)) %>%
  melt(id.vars = vars_id) %>%
  mutate(variable = paste(variable, time, sep = "_")) %>%
  select(-time) %>%           # remove unwanted columns
  dcast(Genotype ~ variable)

ishihara_pulse_data
```

<div data-pagedtable="false">

<script data-pagedtable-source type="application/json">
{"columns":[{"label":["Genotype"],"name":[1],"type":["chr"],"align":["left"]},{"label":["dFree_Ala_0"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["dFree_Ala_24"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["dFree_Ser_0"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["dFree_Ser_24"],"name":[5],"type":["dbl"],"align":["right"]},{"label":["dGlc_0"],"name":[6],"type":["dbl"],"align":["right"]},{"label":["dGlc_24"],"name":[7],"type":["dbl"],"align":["right"]},{"label":["dProt_Ala_0"],"name":[8],"type":["dbl"],"align":["right"]},{"label":["dProt_Ala_24"],"name":[9],"type":["dbl"],"align":["right"]},{"label":["dProt_Ser_0"],"name":[10],"type":["dbl"],"align":["right"]},{"label":["dProt_Ser_24"],"name":[11],"type":["dbl"],"align":["right"]},{"label":["Free_Ala_0"],"name":[12],"type":["dbl"],"align":["right"]},{"label":["Free_Ala_24"],"name":[13],"type":["dbl"],"align":["right"]},{"label":["Free_Ser_0"],"name":[14],"type":["dbl"],"align":["right"]},{"label":["Free_Ser_24"],"name":[15],"type":["dbl"],"align":["right"]},{"label":["Glc_0"],"name":[16],"type":["dbl"],"align":["right"]},{"label":["Glc_24"],"name":[17],"type":["dbl"],"align":["right"]},{"label":["Prot_Ala_0"],"name":[18],"type":["dbl"],"align":["right"]},{"label":["Prot_Ala_24"],"name":[19],"type":["dbl"],"align":["right"]},{"label":["Prot_Ser_0"],"name":[20],"type":["dbl"],"align":["right"]},{"label":["Prot_Ser_24"],"name":[21],"type":["dbl"],"align":["right"]}],"data":[{"1":"Ang0","2":"0.002126824","3":"0.01048293","4":"0.001426218","5":"0.011058050","6":"0.005299616","7":"0.02322525","8":"0.003374540","9":"0.011651814","10":"0.0017214871","11":"0.0044318631","12":"0.009462740","13":"0.8092720","14":"0.004770930","15":"0.8275785","16":"0.03205400","17":"0.2636390","18":"0.013619043","19":"0.2374495","20":"0.009270087","21":"0.2316967"},{"1":"Bsch2","2":"0.002695762","3":"0.02044153","4":"0.001333393","5":"0.017225799","6":"0.005818499","7":"0.01320393","8":"0.003030798","9":"0.008735140","10":"0.0033503683","11":"0.0056304478","12":"0.007784377","13":"0.8890829","14":"0.003791980","15":"0.8761937","16":"0.03397107","17":"0.2789667","18":"0.010103613","19":"0.2187777","20":"0.006760957","21":"0.2054883"},{"1":"Bu2","2":"0.002325720","3":"0.03147734","4":"0.001356079","5":"0.016717538","6":"0.003681750","7":"0.02063305","8":"0.006476477","9":"0.009441511","10":"0.0008735688","11":"0.0046942183","12":"0.007409200","13":"0.8234368","14":"0.003936590","15":"0.8329250","16":"0.02914440","17":"0.2593753","18":"0.012865933","19":"0.2230820","20":"0.009391077","21":"0.2105703"},{"1":"Col0","2":"0.001126388","3":"0.01060446","4":"0.002281206","5":"0.006752922","6":"0.004827112","7":"0.01706044","8":"0.004135325","9":"0.015219434","10":"0.0016434416","11":"0.0040678176","12":"0.009273507","13":"0.8163778","14":"0.003588647","15":"0.8054534","16":"0.03755323","17":"0.2542177","18":"0.008070567","19":"0.2103733","20":"0.010000263","21":"0.2146770"},{"1":"Cvi","2":"0.003833341","3":"0.04245023","4":"0.002722050","5":"0.040193648","6":"0.003533195","7":"0.01859113","8":"0.005755947","9":"0.009831289","10":"0.0012569448","11":"0.0047906729","12":"0.008932330","13":"0.7840713","14":"0.006480517","15":"0.7921709","16":"0.03227132","17":"0.2460667","18":"0.011169167","19":"0.2199293","20":"0.001799510","21":"0.2124187"},{"1":"Da0","2":"0.003171368","3":"0.02489737","4":"0.002753668","5":"0.049629908","6":"0.006598357","7":"0.01950308","8":"0.003210396","9":"0.005098036","10":"0.0010666681","11":"0.0011948206","12":"0.007302007","13":"0.8821298","14":"0.003269073","15":"0.8386182","16":"0.03302507","17":"0.2621507","18":"0.017047567","19":"0.2375433","20":"0.011475593","21":"0.2245370"},{"1":"Ei2","2":"0.002226488","3":"0.02718531","4":"0.002516555","5":"0.018454254","6":"0.004966955","7":"0.03021185","8":"0.004202170","9":"0.020416905","10":"0.0026342749","11":"0.0090426647","12":"0.009970023","13":"0.8609352","14":"0.006907917","15":"0.8766758","16":"0.03180587","17":"0.2561917","18":"0.012837857","19":"0.1932835","20":"0.009345617","21":"0.2069857"},{"1":"Kl0","2":"0.001976794","3":"0.03119187","4":"0.002125056","5":"0.018088349","6":"0.005806594","7":"0.02378980","8":"0.004580700","9":"0.011492392","10":"0.0038898616","11":"0.0073066272","12":"0.008030447","13":"0.8829063","14":"0.003790420","15":"0.8582611","16":"0.03369093","17":"0.2549927","18":"0.008917267","19":"0.2315870","20":"0.007611145","21":"0.2195983"},{"1":"Lip0","2":"0.002705954","3":"0.03051726","4":"0.001362854","5":"0.015832671","6":"0.006842885","7":"0.02065301","8":"0.000000000","9":"0.007884777","10":"0.0021325129","11":"0.0010644312","12":"0.008474723","13":"0.8394072","14":"0.004557383","15":"0.8510323","16":"0.03359007","17":"0.2584837","18":"0.000000000","19":"0.2343417","20":"0.002858457","21":"0.2253937"},{"1":"Mh1","2":"0.002702706","3":"0.01306236","4":"0.002733441","5":"0.009836593","6":"0.004325808","7":"0.01983424","8":"0.002699894","9":"0.003070414","10":"0.0020504533","11":"0.0018631249","12":"0.009096723","13":"0.8761099","14":"0.003765343","15":"0.8611614","16":"0.03049023","17":"0.2652400","18":"0.014580200","19":"0.2342067","20":"0.009898377","21":"0.2191760"},{"1":"Old1","2":"0.002032038","3":"0.01128886","4":"0.002493667","5":"0.014742924","6":"0.006423412","7":"0.02338232","8":"0.005002250","9":"0.014798081","10":"0.0039058189","11":"0.0040170839","12":"0.009465063","13":"0.8736164","14":"0.004966187","15":"0.8674525","16":"0.03385850","17":"0.2869197","18":"0.009582200","19":"0.2122303","20":"0.006155984","21":"0.2163223"},{"1":"Peter","2":"0.002403649","3":"0.01851484","4":"0.001828871","5":"0.018955672","6":"0.005188284","7":"0.01910530","8":"0.003535399","9":"0.004015300","10":"0.0031388755","11":"0.0002598348","12":"0.009176127","13":"0.9111036","14":"0.004794867","15":"0.8689358","16":"0.03613338","17":"0.2531627","18":"0.006787780","19":"0.2381563","20":"0.005484283","21":"0.2254603"},{"1":"RRS7","2":"0.002678887","3":"0.02094184","4":"0.001918678","5":"0.017388048","6":"0.004765221","7":"0.02824934","8":"0.004466206","9":"0.015625132","10":"0.0031028942","11":"0.0105780023","12":"0.008115327","13":"0.8730362","14":"0.005356247","15":"0.8806044","16":"0.03131897","17":"0.2739157","18":"0.008530867","19":"0.2118733","20":"0.007539757","21":"0.2183470"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>

</div>

``` r
ishihara_RGRp <- ishihara_pulse_data %>%
  mutate_with_error( RGRp ~ Glc_24 - Glc_0 ) %>%
  select(c("Genotype", "RGRp", "dRGRp"))

ishihara_RGRp
```

<div data-pagedtable="false">

<script data-pagedtable-source type="application/json">
{"columns":[{"label":["Genotype"],"name":[1],"type":["chr"],"align":["left"]},{"label":["RGRp"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["dRGRp"],"name":[3],"type":["dbl"],"align":["right"]}],"data":[{"1":"Ang0","2":"0.2315850","3":"0.02382222"},{"1":"Bsch2","2":"0.2449956","3":"0.01442910"},{"1":"Bu2","2":"0.2302309","3":"0.02095896"},{"1":"Col0","2":"0.2166644","3":"0.01773019"},{"1":"Cvi","2":"0.2137953","3":"0.01892389"},{"1":"Da0","2":"0.2291256","3":"0.02058904"},{"1":"Ei2","2":"0.2243858","3":"0.03061742"},{"1":"Kl0","2":"0.2213017","3":"0.02448819"},{"1":"Lip0","2":"0.2248936","3":"0.02175711"},{"1":"Mh1","2":"0.2347498","3":"0.02030048"},{"1":"Old1","2":"0.2530612","3":"0.02424857"},{"1":"Peter","2":"0.2170293","3":"0.01979725"},{"1":"RRS7","2":"0.2425967","3":"0.02864843"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>

</div>

## Estimation of KD

Calculation of *K*<sub>*d*<sub>*p*</sub></sub> can then be easily
achieved by joining the previously calculated datasets containing
*K*<sub>*s*</sub> and *R**G**R*<sub>*p*</sub><sup>*S**T**R*</sup>
results and apply the *K*<sub>*d*<sub>*p*</sub></sub> formula.

``` r
ishihara_KDp <- join(ishihara_KS, ishihara_RGRp, by = "Genotype") %>%
  mutate_with_error( KDp_Ala ~ KS_Ala - RGRp ) %>%
  mutate_with_error( KDp_Ser ~ KS_Ser - RGRp ) %>%
  select(c("Genotype", "KDp_Ala", "dKDp_Ala", "KDp_Ser", "dKDp_Ser"))

ishihara_KDp
```

<div data-pagedtable="false">

<script data-pagedtable-source type="application/json">
{"columns":[{"label":["Genotype"],"name":[1],"type":["chr"],"align":["left"]},{"label":["KDp_Ala"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["dKDp_Ala"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["KDp_Ser"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["dKDp_Ser"],"name":[5],"type":["dbl"],"align":["right"]}],"data":[{"1":"Ang0","2":"0.0585447338","3":"0.02788334","4":"0.051515584","5":"0.02457166"},{"1":"Bsch2","2":"0.0028722567","3":"0.01789499","4":"-0.012184118","5":"0.01616542"},{"1":"Bu2","2":"0.0391329180","3":"0.02455280","4":"0.024025510","5":"0.02239057"},{"1":"Col0","2":"0.0427624941","3":"0.02589690","4":"0.048069664","5":"0.01854007"},{"1":"Cvi","2":"0.0652599154","3":"0.02491661","4":"0.055730077","5":"0.02224830"},{"1":"Da0","2":"0.0469675102","3":"0.02320318","4":"0.031850441","5":"0.02228795"},{"1":"Ei2","2":"-0.0019154039","3":"0.03882489","4":"0.013855867","5":"0.03265044"},{"1":"Kl0","2":"0.0447117525","3":"0.02835981","4":"0.030940915","5":"0.02640826"},{"1":"Lip0","2":"0.0523617070","3":"0.02433499","4":"0.041775111","5":"0.02245822"},{"1":"Mh1","2":"0.0348761323","3":"0.02076161","4":"0.017572368","5":"0.02055117"},{"1":"Old1","2":"-0.0092680313","3":"0.02972733","4":"-0.004567471","5":"0.02482559"},{"1":"Peter","2":"0.0505561741","3":"0.02069180","4":"0.036291322","5":"0.02015529"},{"1":"RRS7","2":"-0.0009584293","3":"0.03394643","4":"0.006424688","5":"0.03132433"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>

</div>

# CHASE EXPERIMENTS

``` r
ishihara_chase_data <- ishihara2017_summary %>%
  subset(time %in% c(24, 120)) %>%
  melt(id.vars = vars_id) %>%
  mutate(variable = paste(variable, time, sep = "_")) %>%
  select(-time) %>%           # remove unwanted columns
  dcast(Genotype ~ variable)

ishihara_chase_data
```

<div data-pagedtable="false">

<script data-pagedtable-source type="application/json">
{"columns":[{"label":["Genotype"],"name":[1],"type":["chr"],"align":["left"]},{"label":["dFree_Ala_120"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["dFree_Ala_24"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["dFree_Ser_120"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["dFree_Ser_24"],"name":[5],"type":["dbl"],"align":["right"]},{"label":["dGlc_120"],"name":[6],"type":["dbl"],"align":["right"]},{"label":["dGlc_24"],"name":[7],"type":["dbl"],"align":["right"]},{"label":["dProt_Ala_120"],"name":[8],"type":["dbl"],"align":["right"]},{"label":["dProt_Ala_24"],"name":[9],"type":["dbl"],"align":["right"]},{"label":["dProt_Ser_120"],"name":[10],"type":["dbl"],"align":["right"]},{"label":["dProt_Ser_24"],"name":[11],"type":["dbl"],"align":["right"]},{"label":["Free_Ala_120"],"name":[12],"type":["dbl"],"align":["right"]},{"label":["Free_Ala_24"],"name":[13],"type":["dbl"],"align":["right"]},{"label":["Free_Ser_120"],"name":[14],"type":["dbl"],"align":["right"]},{"label":["Free_Ser_24"],"name":[15],"type":["dbl"],"align":["right"]},{"label":["Glc_120"],"name":[16],"type":["dbl"],"align":["right"]},{"label":["Glc_24"],"name":[17],"type":["dbl"],"align":["right"]},{"label":["Prot_Ala_120"],"name":[18],"type":["dbl"],"align":["right"]},{"label":["Prot_Ala_24"],"name":[19],"type":["dbl"],"align":["right"]},{"label":["Prot_Ser_120"],"name":[20],"type":["dbl"],"align":["right"]},{"label":["Prot_Ser_24"],"name":[21],"type":["dbl"],"align":["right"]}],"data":[{"1":"Ang0","2":"0.004990727","3":"0.01048293","4":"0.004530858","5":"0.011058050","6":"0.009765074","7":"0.02322525","8":"0.0136208625","9":"0.011651814","10":"0.0080657412","11":"0.0044318631","12":"0.01795434","13":"0.8092720","14":"0.02416673","15":"0.8275785","16":"0.10863353","17":"0.2636390","18":"0.08127467","19":"0.2374495","20":"0.08113433","21":"0.2316967"},{"1":"Bsch2","2":"0.002869262","3":"0.02044153","4":"0.004681336","5":"0.017225799","6":"0.004073121","7":"0.01320393","8":"0.0085570543","9":"0.008735140","10":"0.0024922948","11":"0.0056304478","12":"0.01501821","13":"0.8890829","14":"0.01852524","15":"0.8761937","16":"0.10341253","17":"0.2789667","18":"0.07521367","19":"0.2187777","20":"0.07052667","21":"0.2054883"},{"1":"Bu2","2":"0.003441396","3":"0.03147734","4":"0.003929320","5":"0.016717538","6":"0.005101506","7":"0.02063305","8":"0.0063998949","9":"0.009441511","10":"0.0025022574","11":"0.0046942183","12":"0.01557824","13":"0.8234368","14":"0.01808161","15":"0.8329250","16":"0.09769370","17":"0.2593753","18":"0.08483100","19":"0.2230820","20":"0.07672033","21":"0.2105703"},{"1":"Col0","2":"0.002925453","3":"0.01060446","4":"0.004045988","5":"0.006752922","6":"0.006412159","7":"0.01706044","8":"0.0048597779","9":"0.015219434","10":"0.0020369607","11":"0.0040678176","12":"0.01512074","13":"0.8163778","14":"0.01791289","15":"0.8054534","16":"0.10078663","17":"0.2542177","18":"0.08532133","19":"0.2103733","20":"0.07820833","21":"0.2146770"},{"1":"Cvi","2":"0.001827630","3":"0.04245023","4":"0.006964248","5":"0.040193648","6":"0.006617909","7":"0.01859113","8":"0.0029895713","9":"0.009831289","10":"0.0020182625","11":"0.0047906729","12":"0.01851670","13":"0.7840713","14":"0.02387593","15":"0.7921709","16":"0.10506427","17":"0.2460667","18":"0.08587767","19":"0.2199293","20":"0.07752567","21":"0.2124187"},{"1":"Da0","2":"0.002575688","3":"0.02489737","4":"0.004514705","5":"0.049629908","6":"0.006714886","7":"0.01950308","8":"0.0012310763","9":"0.005098036","10":"0.0020256206","11":"0.0011948206","12":"0.01774933","13":"0.8821298","14":"0.02158789","15":"0.8386182","16":"0.10420687","17":"0.2621507","18":"0.08577367","19":"0.2375433","20":"0.07702400","21":"0.2245370"},{"1":"Ei2","2":"0.003214255","3":"0.02718531","4":"0.004015927","5":"0.018454254","6":"0.005127667","7":"0.03021185","8":"0.0025310959","9":"0.020416905","10":"0.0048448822","11":"0.0090426647","12":"0.01476542","13":"0.8609352","14":"0.01947080","15":"0.8766758","16":"0.10285327","17":"0.2561917","18":"0.08054800","19":"0.1932835","20":"0.07473633","21":"0.2069857"},{"1":"Kl0","2":"0.003588624","3":"0.03119187","4":"0.004287024","5":"0.018088349","6":"0.008522737","7":"0.02378980","8":"0.0052151349","9":"0.011492392","10":"0.0004797521","11":"0.0073066272","12":"0.01653060","13":"0.8829063","14":"0.02068785","15":"0.8582611","16":"0.09676523","17":"0.2549927","18":"0.08879700","19":"0.2315870","20":"0.07967933","21":"0.2195983"},{"1":"Lip0","2":"0.004025762","3":"0.03051726","4":"0.002924188","5":"0.015832671","6":"0.005823850","7":"0.02065301","8":"0.0098269446","9":"0.007884777","10":"0.0063470362","11":"0.0010644312","12":"0.01712658","13":"0.8394072","14":"0.02209340","15":"0.8510323","16":"0.10204487","17":"0.2584837","18":"0.06576250","19":"0.2343417","20":"0.07318550","21":"0.2253937"},{"1":"Mh1","2":"0.002834276","3":"0.01306236","4":"0.003546673","5":"0.009836593","6":"0.001459910","7":"0.01983424","8":"0.0006541767","9":"0.003070414","10":"0.0025700763","11":"0.0018631249","12":"0.01599116","13":"0.8761099","14":"0.01937110","15":"0.8611614","16":"0.10004657","17":"0.2652400","18":"0.09008933","19":"0.2342067","20":"0.08320000","21":"0.2191760"},{"1":"Old1","2":"0.002482685","3":"0.01128886","4":"0.006172341","5":"0.014742924","6":"0.007784956","7":"0.02338232","8":"0.0012508408","9":"0.014798081","10":"0.0043583597","11":"0.0040170839","12":"0.01718695","13":"0.8736164","14":"0.01582984","15":"0.8674525","16":"0.09951567","17":"0.2869197","18":"0.08862367","19":"0.2122303","20":"0.08097400","21":"0.2163223"},{"1":"Peter","2":"0.002721006","3":"0.01851484","4":"0.004071200","5":"0.018955672","6":"0.007016288","7":"0.01910530","8":"0.0091971244","9":"0.004015300","10":"0.0077339376","11":"0.0002598348","12":"0.01723750","13":"0.9111036","14":"0.01941479","15":"0.8689358","16":"0.10504147","17":"0.2531627","18":"0.08547400","19":"0.2381563","20":"0.07944800","21":"0.2254603"},{"1":"RRS7","2":"0.004531040","3":"0.02094184","4":"0.004021764","5":"0.017388048","6":"0.005897806","7":"0.02824934","8":"0.0063323256","9":"0.015625132","10":"0.0056974212","11":"0.0105780023","12":"0.01513405","13":"0.8730362","14":"0.01877156","15":"0.8806044","16":"0.10538043","17":"0.2739157","18":"0.08422867","19":"0.2118733","20":"0.08190367","21":"0.2183470"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>

</div>

## Estimation of KS

Note that results are in \#/day
:(120*h* − 24*h*) ÷ 24*h*/*d**a**y* = 4*d**a**y**s*; This value has to
be input as ‘numeric’ and not as an object given the behaviour of
`mutate_with_error()`. (This can be solved dynamically, to implement in
the future.)

``` r
# ishihara_KSloss <- ishihara_chase_data %>%
#   mutate_with_error( KSloss_Ala ~ (log(Prot_Ala_120) - log(Prot_Ala_24)) / (4) ) %>%
#   mutate_with_error( KSloss_Ser ~ (log(Prot_Ser_120) - log(Prot_Ser_24)) / (4) ) %>%
#   # remove unwanted columns
#   select(c("Genotype", "KSloss_Ala", "dKSloss_Ala", "KSloss_Ser", "dKSloss_Ser"))

ishihara_KSloss <- ishihara_chase_data %>%
  mutate_with_error( KSloss_Ala ~ -((log(Prot_Ala_120) - log(Prot_Ala_24))) / (4) ) %>%
  mutate_with_error( KSloss_Ser ~ -((log(Prot_Ser_120) - log(Prot_Ser_24))) / (4) ) %>%
  # remove unwanted columns
  select(c("Genotype", "KSloss_Ala", "dKSloss_Ala", "KSloss_Ser", "dKSloss_Ser"))

ishihara_KSloss
```

<div data-pagedtable="false">

<script data-pagedtable-source type="application/json">
{"columns":[{"label":["Genotype"],"name":[1],"type":["chr"],"align":["left"]},{"label":["KSloss_Ala"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["dKSloss_Ala"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["KSloss_Ser"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["dKSloss_Ser"],"name":[5],"type":["dbl"],"align":["right"]}],"data":[{"1":"Ang0","2":"0.2680302","3":"0.043656695","4":"0.2623307","5":"0.025308913"},{"1":"Bsch2","2":"0.2669308","3":"0.030143165","4":"0.2673496","5":"0.011179154"},{"1":"Bu2","2":"0.2417196","3":"0.021625894","4":"0.2524132","5":"0.009876521"},{"1":"Col0","2":"0.2256148","3":"0.023019090","4":"0.2524396","5":"0.008052197"},{"1":"Cvi","2":"0.2350956","3":"0.014164537","4":"0.2519875","5":"0.008610961"},{"1":"Da0","2":"0.2546595","3":"0.006454618","4":"0.2674809","5":"0.006707879"},{"1":"Ei2","2":"0.2188262","3":"0.027551694","4":"0.2546708","5":"0.019543288"},{"1":"Kl0","2":"0.2396507","3":"0.019222253","4":"0.2534475","5":"0.008453271"},{"1":"Lip0","2":"0.3176826","3":"0.038292997","4":"0.2812128","5":"0.021713452"},{"1":"Mh1","2":"0.2388505","3":"0.003746635","4":"0.2421569","5":"0.008009655"},{"1":"Old1","2":"0.2183183","3":"0.017785165","4":"0.2456604","5":"0.014234387"},{"1":"Peter","2":"0.2561788","3":"0.027228575","4":"0.2607604","5":"0.024338182"},{"1":"RRS7","2":"0.2306133","3":"0.026328162","4":"0.2451354","5":"0.021192475"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>

</div>

## Estimation of RGRSTR

Similarly to what was done for the pulse data, the
*R**G**R*<sub>*c*</sub><sup>*S**T**R*</sup> calculation also demands
re-organization of the original dataset.

Note that results are in \#/day
:(120*h* − 24*h*) ÷ 24*h*/*d**a**y* = 4*d**a**y**s*; This value has to
be input as ‘numeric’ and not as an object given the behaviour of
`mutate_with_error()`.

``` r
ishihara_RGRc <- ishihara_chase_data %>%
  mutate_with_error( RGRc ~ 1 - (Glc_120 / Glc_24)^(1/4) ) %>% 
  select(c("Genotype", "RGRc", "dRGRc"))

ishihara_RGRc
```

<div data-pagedtable="false">

<script data-pagedtable-source type="application/json">
{"columns":[{"label":["Genotype"],"name":[1],"type":["chr"],"align":["left"]},{"label":["RGRc"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["dRGRc"],"name":[3],"type":["dbl"],"align":["right"]}],"data":[{"1":"Ang0","2":"0.1988044","3":"0.02520977"},{"1":"Bsch2","2":"0.2197115","3":"0.01201179"},{"1":"Bu2","2":"0.2165984","3":"0.01863659"},{"1":"Col0","2":"0.2064957","3":"0.01834452"},{"1":"Cvi","2":"0.1916479","3":"0.01987864"},{"1":"Da0","2":"0.2059710","3":"0.01953769"},{"1":"Ei2","2":"0.2039996","3":"0.02547835"},{"1":"Kl0","2":"0.2151297","3":"0.02517527"},{"1":"Lip0","2":"0.2073353","3":"0.01945792"},{"1":"Mh1","2":"0.2163163","3":"0.01492700"},{"1":"Old1","2":"0.2325806","3":"0.02167282"},{"1":"Peter","2":"0.1974164","3":"0.02022131"},{"1":"RRS7","2":"0.2124361","3":"0.02310295"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>

</div>

## Estimation of KD

``` r
# ishihara_KDc <- join(ishihara_KSloss, ishihara_RGRc, by = "Genotype") %>%
#   mutate_with_error( KDc_Ala ~ -KSloss_Ala - RGRc ) %>%
#   mutate_with_error( KDc_Ser ~ -KSloss_Ser - RGRc ) %>%
#   select(c("Genotype", "KDc_Ala", "dKDc_Ala", "KDc_Ser", "dKDc_Ser"))

ishihara_KDc <- join(ishihara_KSloss, ishihara_RGRc, by = "Genotype") %>%
  mutate_with_error( KDc_Ala ~ KSloss_Ala - RGRc ) %>%
  mutate_with_error( KDc_Ser ~ KSloss_Ser - RGRc ) %>%
  select(c("Genotype", "KDc_Ala", "dKDc_Ala", "KDc_Ser", "dKDc_Ser"))

ishihara_KDc
```

<div data-pagedtable="false">

<script data-pagedtable-source type="application/json">
{"columns":[{"label":["Genotype"],"name":[1],"type":["chr"],"align":["left"]},{"label":["KDc_Ala"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["dKDc_Ala"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["KDc_Ser"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["dKDc_Ser"],"name":[5],"type":["dbl"],"align":["right"]}],"data":[{"1":"Ang0","2":"0.06922576","3":"0.05041269","4":"0.06352632","5":"0.03572217"},{"1":"Bsch2","2":"0.04721928","3":"0.03244832","4":"0.04763811","5":"0.01640904"},{"1":"Bu2","2":"0.02512122","3":"0.02854824","4":"0.03581487","5":"0.02109190"},{"1":"Col0","2":"0.01911914","3":"0.02943467","4":"0.04594392","5":"0.02003396"},{"1":"Cvi","2":"0.04344770","3":"0.02440890","4":"0.06033961","5":"0.02166354"},{"1":"Da0","2":"0.04868847","3":"0.02057628","4":"0.06150982","5":"0.02065712"},{"1":"Ei2","2":"0.01482656","3":"0.03752655","4":"0.05067117","5":"0.03211054"},{"1":"Kl0","2":"0.02452102","3":"0.03167474","4":"0.03831780","5":"0.02655658"},{"1":"Lip0","2":"0.11034729","3":"0.04295305","4":"0.07387749","5":"0.02915621"},{"1":"Mh1","2":"0.02253420","3":"0.01539002","4":"0.02584059","5":"0.01694019"},{"1":"Old1","2":"-0.01426227","3":"0.02803610","4":"0.01307979","5":"0.02592930"},{"1":"Peter","2":"0.05876237","3":"0.03391602","4":"0.06334398","5":"0.03164251"},{"1":"RRS7","2":"0.01817718","3":"0.03502739","4":"0.03269930","5":"0.03135071"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>

</div>
