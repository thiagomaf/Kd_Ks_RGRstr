Hiro’2020 - Assessing protein synthesis and degradation rates via amino
acid analysis for Current Protocols in Plant Biology
================

# LOAD LIBRARIES

``` r
library(reshape2) # melt(); citation("reshape2")
library(dplyr)    # %>%;    citation("dplyr")
library(plyr)     # ddply;  citation("plyr") # must be loaded after dplyr
library(rlang)

library(pander)   # pandoc.table
```

# DEFINE FUNCTIONS

## Standard error

The `se()` function is used to calculate the `standard error` of the
mean. `x` represents a numeric vector containing replicates of a given
measurement. The `na.rm = TRUE` argument indicates that by default this
function ignores missing values.

``` r
# x:  numeric

se <- function(x, ...) {
  sd(x, ...) / sqrt(length(x))
}
```

``` r
se(c(0.647603, 0.547048, 0.529873, NA, 0.908040, 0.835195))
```

    ## [1] NA

``` r
se(c(0.647603, 0.547048, 0.529873, NA, 0.908040, 0.835195), na.rm = TRUE)
```

    ## [1] 0.06965193

## Gaussian error propagation

The following function is based on article published on January 22, 2015
by Lee Pang in the R bloggers website
(<https://www.r-bloggers.com/easy-error-propagation-in-r/>). It allows
convenient integration with libraries of the tidyverse and the dplyr
grammar. It builds on the mutate() function to apply the chain rule on
any given mathematical formula.

To illustrate its working let’s assume one needs to propagate the error
on the following *Z* calculation:

The Gaussian propagated error *d**Z* can be calculated by applying the
chain-rule to *Z*, as follows:

The `mutate_with_error()` receives any given formula, construct the
respective formula for error propagation and returns the results of both
calculations. For this two arguments must be input to the
`mutate_with_error()` function. First, the `.data` argument receives a
`data.frame` containing the mean values to be used in the calculation
(i.e. *X* and *Y* in the example above) plus the standard error of these
means (i.e. *d**X* and *d**Y*) as individual columns. This nomenclature
is important: all columns containing standard errors must be named with
*d* appended to its respective mean values column. Then `f` receives a
`formula` object indicating the calculation to be done. *Vide* below for
more details on the structure of the datasets.

Inside the `mutate_with_error()` function we have the `exprs` object
which is a list of the two calculations to be done - the value of
interest and the propagated error. First, the `deparse(f[[3]])` command
transform the right-hand side of the formula `f` into a `character`
string. Then, a new `character` string is constructed containing the
full right-hand side of the formula that will be used to calculated the
propagated error (*vide* below). Finally, the left-hand side of the new
error propagation formula is created by appending the character *d* to
the original formula left-hand side (i.e. *Z* becomes *d**Z*). The
`mutate_with_error()` run these commands and return the results of the
calculation defined by the formula and its associated propagated error
appended to `.data`.

``` r
# .data: data.frame
#     f: formula
mutate_with_error = function(.data, f) {
  require(dplyr)
  
  exprs = list(
    # expression to compute new variable values
    deparse(f[[3]]),
    
    # expression to compute new variable errors
    sapply(all.vars(f[[3]]), function(v) {
      dfdp = deparse(D(f[[3]], v))
      sprintf('(d%s*(%s))^2', v, dfdp)
    }) %>%
      paste(collapse='+') %>%
      sprintf('sqrt(%s)', .)
  )
  
  names(exprs) = c(
    deparse(f[[2]]),                 # unchanged names
    sprintf('d%s', deparse(f[[2]]))  # 'd' appended to the names
  )
  
  # MATHEMAGICS!
  .data[names(exprs)] <- lapply(exprs , function(x) { eval(parse(text= x), envir = .data) })
  #.data %>% mutate_(.dots=exprs) #### -> mutate_() is deprecated, figure out how to fix.
  
  .data
}
```

``` r
data.frame(X = c(0.647, 0.547, 0.529, 0.908, 0.835), Y = c(1.072, 0.905, 0.877, 1.503, 1.383)) %>%
  summarise(dX = se(X), dY = se(Y), X = mean(X), Y = mean(Y)) %>%
  mutate_with_error(Z ~ (X-Y)/(X+Y)^2) %>%
  select(X, dX, Y, dY, Z, dZ) %>%
  # pandoc.table()
  pander()
```

|   X    |   dX    |   Y   |   dY   |    Z    |   dZ    |
|:------:|:-------:|:-----:|:------:|:-------:|:-------:|
| 0.6932 | 0.07639 | 1.148 | 0.1264 | -0.1342 | 0.03859 |

# LOAD DATA

The sections below demonstrates the procedure for calculating
*K*<sub>*s*</sub>, *K*<sub>*d*</sub> and *R**G**R*<sup>*S**T**R*</sup>
using data from Ishihara et al., 2017.

Datasets from the original publication are available online at \[LINK\].
Datasets are expected to contain replicate measurements as rows,
metadata information and measurement values as columns. Data from
Ishihara et al., 2017 is composed by replicate measurements from three
independent experiments (`Exp`) done in various genotypes (`Genotype`)
at different time points (`time`). It contains measurements of 13C
labelling alanine and serine enrichments in proteins (`Prot_Ala` and
`Prot_Ser`) and in free amino acids (`Free_Ala` and `Free_Ser`) plus
glucose enrichment in cell walls (`Glc`). \[NEED TO CHECK THE TEXT
ITSELF, PHRASE BETTER\]

-   All missing values should be set as `NA` in your original table
-   `CSV` files are a convenient way of loading data to R.

``` r
ishihara2017_data <- read.csv2("data/KDKSRGR_13C.enrichment[3].csv")

# check data structure
str(ishihara2017_data)
```

    ## 'data.frame':    117 obs. of  8 variables:
    ##  $ Genotype: chr  "Ang0" "Bsch2" "Bu2" "Col0" ...
    ##  $ Exp     : chr  "Exp1" "Exp1" "Exp1" "Exp1" ...
    ##  $ time    : int  0 0 0 0 0 0 0 0 0 0 ...
    ##  $ Prot_Ala: num  0.00827 0.00999 0 0.01054 0 ...
    ##  $ Prot_Ser: num  0.01137 0.01236 0.00932 0.01314 0 ...
    ##  $ Free_Ala: num  0.0126 0.0129 0.0119 0.0114 0.0164 ...
    ##  $ Free_Ser: num  0.00757 0.00637 0.00664 0.00782 0.01192 ...
    ##  $ Glc     : num  0.0361 0.0422 0.0343 0.0363 0.0344 ...

# PREPARE DATA

There are many different ways in which R can prepare datasets.
Nevertheless, the important bits are: the data must be summarised -
i.e. the mean and standard error of the mean should be used below which
must be placed in individual columns with names as indicated above.

``` r
vars_prot <- c("Prot_Ala", "Prot_Ser")
vars_free <- c("Free_Ala", "Free_Ser")
vars_glc  <- c("Glc")
vars_id   <- c("Genotype", "time")

ishihara2017_summary <- ishihara2017_data %>%
  #ddply(.(Genotype, time), function(each.data) {
  ddply(as.quoted(vars_id), function(each.data) {
    ldply(c(vars_prot, vars_free, vars_glc), function(each_var) {
      rbind(
        data.frame(variable = each_var,              value = mean(each.data[,each_var], na.rm = T)),
        data.frame(variable = paste0("d", each_var), value =   se(each.data[,each_var], na.rm = T))
      )
    })
  }) %>%
  #dcast(Genotype + time ~ variable)
  dcast(paste(paste(vars_id, collapse = " + "), "variable", sep = " ~ "))
```

``` r
ishihara2017_summary
```

    ##    Genotype time   dFree_Ala   dFree_Ser        dGlc    dProt_Ala    dProt_Ser
    ## 1      Ang0    0 0.002126824 0.001426218 0.005299616 0.0033745404 0.0017214871
    ## 2      Ang0   24 0.010482933 0.011058050 0.023225245 0.0116518145 0.0044318631
    ## 3      Ang0  120 0.004990727 0.004530858 0.009765074 0.0136208625 0.0080657412
    ## 4     Bsch2    0 0.002695762 0.001333393 0.005818499 0.0030307979 0.0033503683
    ## 5     Bsch2   24 0.020441530 0.017225799 0.013203935 0.0087351405 0.0056304478
    ## 6     Bsch2  120 0.002869262 0.004681336 0.004073121 0.0085570543 0.0024922948
    ## 7       Bu2    0 0.002325720 0.001356079 0.003681750 0.0064764765 0.0008735688
    ## 8       Bu2   24 0.031477344 0.016717538 0.020633051 0.0094415111 0.0046942183
    ## 9       Bu2  120 0.003441396 0.003929320 0.005101506 0.0063998949 0.0025022574
    ## 10     Col0    0 0.001126388 0.002281206 0.004827112 0.0041353248 0.0016434416
    ## 11     Col0   24 0.010604461 0.006752922 0.017060436 0.0152194339 0.0040678176
    ## 12     Col0  120 0.002925453 0.004045988 0.006412159 0.0048597779 0.0020369607
    ## 13      Cvi    0 0.003833341 0.002722050 0.003533195 0.0057559466 0.0012569448
    ## 14      Cvi   24 0.042450229 0.040193648 0.018591130 0.0098312887 0.0047906729
    ## 15      Cvi  120 0.001827630 0.006964248 0.006617909 0.0029895713 0.0020182625
    ## 16      Da0    0 0.003171368 0.002753668 0.006598357 0.0032103964 0.0010666681
    ## 17      Da0   24 0.024897371 0.049629908 0.019503083 0.0050980360 0.0011948206
    ## 18      Da0  120 0.002575688 0.004514705 0.006714886 0.0012310763 0.0020256206
    ## 19      Ei2    0 0.002226488 0.002516555 0.004966955 0.0042021701 0.0026342749
    ## 20      Ei2   24 0.027185309 0.018454254 0.030211849 0.0204169053 0.0090426647
    ## 21      Ei2  120 0.003214255 0.004015927 0.005127667 0.0025310959 0.0048448822
    ## 22      Kl0    0 0.001976794 0.002125056 0.005806594 0.0045807005 0.0038898616
    ## 23      Kl0   24 0.031191870 0.018088349 0.023789804 0.0114923918 0.0073066272
    ## 24      Kl0  120 0.003588624 0.004287024 0.008522737 0.0052151349 0.0004797521
    ## 25     Lip0    0 0.002705954 0.001362854 0.006842885 0.0000000000 0.0021325129
    ## 26     Lip0   24 0.030517257 0.015832671 0.020653010 0.0078847772 0.0010644312
    ## 27     Lip0  120 0.004025762 0.002924188 0.005823850 0.0098269446 0.0063470362
    ## 28      Mh1    0 0.002702706 0.002733441 0.004325808 0.0026998943 0.0020504533
    ## 29      Mh1   24 0.013062356 0.009836593 0.019834237 0.0030704139 0.0018631249
    ## 30      Mh1  120 0.002834276 0.003546673 0.001459910 0.0006541767 0.0025700763
    ## 31     Old1    0 0.002032038 0.002493667 0.006423412 0.0050022496 0.0039058189
    ## 32     Old1   24 0.011288860 0.014742924 0.023382317 0.0147980808 0.0040170839
    ## 33     Old1  120 0.002482685 0.006172341 0.007784956 0.0012508408 0.0043583597
    ## 34    Peter    0 0.002403649 0.001828871 0.005188284 0.0035353990 0.0031388755
    ## 35    Peter   24 0.018514841 0.018955672 0.019105303 0.0040153004 0.0002598348
    ## 36    Peter  120 0.002721006 0.004071200 0.007016288 0.0091971244 0.0077339376
    ## 37     RRS7    0 0.002678887 0.001918678 0.004765221 0.0044662061 0.0031028942
    ## 38     RRS7   24 0.020941840 0.017388048 0.028249340 0.0156251319 0.0105780023
    ## 39     RRS7  120 0.004531040 0.004021764 0.005897806 0.0063323256 0.0056974212
    ##       Free_Ala    Free_Ser        Glc    Prot_Ala    Prot_Ser
    ## 1  0.009462740 0.004770930 0.03205400 0.013619043 0.009270087
    ## 2  0.809272000 0.827578500 0.26363900 0.237449500 0.231696667
    ## 3  0.017954339 0.024166732 0.10863353 0.081274667 0.081134333
    ## 4  0.007784377 0.003791980 0.03397107 0.010103613 0.006760957
    ## 5  0.889082898 0.876193727 0.27896667 0.218777667 0.205488333
    ## 6  0.015018215 0.018525244 0.10341253 0.075213667 0.070526667
    ## 7  0.007409200 0.003936590 0.02914440 0.012865933 0.009391077
    ## 8  0.823436794 0.832925030 0.25937533 0.223082000 0.210570333
    ## 9  0.015578244 0.018081609 0.09769370 0.084831000 0.076720333
    ## 10 0.009273507 0.003588647 0.03755323 0.008070567 0.010000263
    ## 11 0.816377776 0.805453353 0.25421767 0.210373333 0.214677000
    ## 12 0.015120744 0.017912886 0.10078663 0.085321333 0.078208333
    ## 13 0.008932330 0.006480517 0.03227132 0.011169167 0.001799510
    ## 14 0.784071272 0.792170861 0.24606667 0.219929333 0.212418667
    ## 15 0.018516702 0.023875932 0.10506427 0.085877667 0.077525667
    ## 16 0.007302007 0.003269073 0.03302507 0.017047567 0.011475593
    ## 17 0.882129788 0.838618210 0.26215067 0.237543333 0.224537000
    ## 18 0.017749334 0.021587890 0.10420687 0.085773667 0.077024000
    ## 19 0.009970023 0.006907917 0.03180587 0.012837857 0.009345617
    ## 20 0.860935151 0.876675816 0.25619167 0.193283500 0.206985667
    ## 21 0.014765420 0.019470800 0.10285327 0.080548000 0.074736333
    ## 22 0.008030447 0.003790420 0.03369093 0.008917267 0.007611145
    ## 23 0.882906308 0.858261056 0.25499267 0.231587000 0.219598333
    ## 24 0.016530602 0.020687847 0.09676523 0.088797000 0.079679333
    ## 25 0.008474723 0.004557383 0.03359007 0.000000000 0.002858457
    ## 26 0.839407206 0.851032332 0.25848367 0.234341667 0.225393667
    ## 27 0.017126584 0.022093400 0.10204487 0.065762500 0.073185500
    ## 28 0.009096723 0.003765343 0.03049023 0.014580200 0.009898377
    ## 29 0.876109860 0.861161430 0.26524000 0.234206667 0.219176000
    ## 30 0.015991158 0.019371099 0.10004657 0.090089333 0.083200000
    ## 31 0.009465063 0.004966187 0.03385850 0.009582200 0.006155984
    ## 32 0.873616444 0.867452540 0.28691967 0.212230333 0.216322333
    ## 33 0.017186947 0.015829843 0.09951567 0.088623667 0.080974000
    ## 34 0.009176127 0.004794867 0.03613338 0.006787780 0.005484283
    ## 35 0.911103611 0.868935825 0.25316267 0.238156333 0.225460333
    ## 36 0.017237502 0.019414792 0.10504147 0.085474000 0.079448000
    ## 37 0.008115327 0.005356247 0.03131897 0.008530867 0.007539757
    ## 38 0.873036152 0.880604385 0.27391567 0.211873333 0.218347000
    ## 39 0.015134053 0.018771557 0.10538043 0.084228667 0.081903667

    ##    Genotype time   dFree_Ala   dFree_Ser        dGlc    dProt_Ala    dProt_Ser
    ## 1      Ang0    0 0.002126824 0.001426218 0.005299616 0.0033745404 0.0017214871
    ## 2      Ang0   24 0.010482933 0.011058050 0.023225245 0.0116518145 0.0044318631
    ## 3      Ang0  120 0.004990727 0.004530858 0.009765074 0.0136208625 0.0080657412
    ## 4     Bsch2    0 0.002695762 0.001333393 0.005818499 0.0030307979 0.0033503683
    ## 5     Bsch2   24 0.020441530 0.017225799 0.013203935 0.0087351405 0.0056304478
    ## 6     Bsch2  120 0.002869262 0.004681336 0.004073121 0.0085570543 0.0024922948
    ## 7       Bu2    0 0.002325720 0.001356079 0.003681750 0.0064764765 0.0008735688
    ## 8       Bu2   24 0.031477344 0.016717538 0.020633051 0.0094415111 0.0046942183
    ## 9       Bu2  120 0.003441396 0.003929320 0.005101506 0.0063998949 0.0025022574
    ## 10     Col0    0 0.001126388 0.002281206 0.004827112 0.0041353248 0.0016434416
    ## 11     Col0   24 0.010604461 0.006752922 0.017060436 0.0152194339 0.0040678176
    ## 12     Col0  120 0.002925453 0.004045988 0.006412159 0.0048597779 0.0020369607
    ## 13      Cvi    0 0.003833341 0.002722050 0.003533195 0.0057559466 0.0012569448
    ## 14      Cvi   24 0.042450229 0.040193648 0.018591130 0.0098312887 0.0047906729
    ## 15      Cvi  120 0.001827630 0.006964248 0.006617909 0.0029895713 0.0020182625
    ## 16      Da0    0 0.003171368 0.002753668 0.006598357 0.0032103964 0.0010666681
    ## 17      Da0   24 0.024897371 0.049629908 0.019503083 0.0050980360 0.0011948206
    ## 18      Da0  120 0.002575688 0.004514705 0.006714886 0.0012310763 0.0020256206
    ## 19      Ei2    0 0.002226488 0.002516555 0.004966955 0.0042021701 0.0026342749
    ## 20      Ei2   24 0.027185309 0.018454254 0.030211849 0.0204169053 0.0090426647
    ## 21      Ei2  120 0.003214255 0.004015927 0.005127667 0.0025310959 0.0048448822
    ## 22      Kl0    0 0.001976794 0.002125056 0.005806594 0.0045807005 0.0038898616
    ## 23      Kl0   24 0.031191870 0.018088349 0.023789804 0.0114923918 0.0073066272
    ## 24      Kl0  120 0.003588624 0.004287024 0.008522737 0.0052151349 0.0004797521
    ## 25     Lip0    0 0.002705954 0.001362854 0.006842885 0.0000000000 0.0021325129
    ## 26     Lip0   24 0.030517257 0.015832671 0.020653010 0.0078847772 0.0010644312
    ## 27     Lip0  120 0.004025762 0.002924188 0.005823850 0.0098269446 0.0063470362
    ## 28      Mh1    0 0.002702706 0.002733441 0.004325808 0.0026998943 0.0020504533
    ## 29      Mh1   24 0.013062356 0.009836593 0.019834237 0.0030704139 0.0018631249
    ## 30      Mh1  120 0.002834276 0.003546673 0.001459910 0.0006541767 0.0025700763
    ## 31     Old1    0 0.002032038 0.002493667 0.006423412 0.0050022496 0.0039058189
    ## 32     Old1   24 0.011288860 0.014742924 0.023382317 0.0147980808 0.0040170839
    ## 33     Old1  120 0.002482685 0.006172341 0.007784956 0.0012508408 0.0043583597
    ## 34    Peter    0 0.002403649 0.001828871 0.005188284 0.0035353990 0.0031388755
    ## 35    Peter   24 0.018514841 0.018955672 0.019105303 0.0040153004 0.0002598348
    ## 36    Peter  120 0.002721006 0.004071200 0.007016288 0.0091971244 0.0077339376
    ## 37     RRS7    0 0.002678887 0.001918678 0.004765221 0.0044662061 0.0031028942
    ## 38     RRS7   24 0.020941840 0.017388048 0.028249340 0.0156251319 0.0105780023
    ## 39     RRS7  120 0.004531040 0.004021764 0.005897806 0.0063323256 0.0056974212
    ##       Free_Ala    Free_Ser        Glc    Prot_Ala    Prot_Ser
    ## 1  0.009462740 0.004770930 0.03205400 0.013619043 0.009270087
    ## 2  0.809272000 0.827578500 0.26363900 0.237449500 0.231696667
    ## 3  0.017954339 0.024166732 0.10863353 0.081274667 0.081134333
    ## 4  0.007784377 0.003791980 0.03397107 0.010103613 0.006760957
    ## 5  0.889082898 0.876193727 0.27896667 0.218777667 0.205488333
    ## 6  0.015018215 0.018525244 0.10341253 0.075213667 0.070526667
    ## 7  0.007409200 0.003936590 0.02914440 0.012865933 0.009391077
    ## 8  0.823436794 0.832925030 0.25937533 0.223082000 0.210570333
    ## 9  0.015578244 0.018081609 0.09769370 0.084831000 0.076720333
    ## 10 0.009273507 0.003588647 0.03755323 0.008070567 0.010000263
    ## 11 0.816377776 0.805453353 0.25421767 0.210373333 0.214677000
    ## 12 0.015120744 0.017912886 0.10078663 0.085321333 0.078208333
    ## 13 0.008932330 0.006480517 0.03227132 0.011169167 0.001799510
    ## 14 0.784071272 0.792170861 0.24606667 0.219929333 0.212418667
    ## 15 0.018516702 0.023875932 0.10506427 0.085877667 0.077525667
    ## 16 0.007302007 0.003269073 0.03302507 0.017047567 0.011475593
    ## 17 0.882129788 0.838618210 0.26215067 0.237543333 0.224537000
    ## 18 0.017749334 0.021587890 0.10420687 0.085773667 0.077024000
    ## 19 0.009970023 0.006907917 0.03180587 0.012837857 0.009345617
    ## 20 0.860935151 0.876675816 0.25619167 0.193283500 0.206985667
    ## 21 0.014765420 0.019470800 0.10285327 0.080548000 0.074736333
    ## 22 0.008030447 0.003790420 0.03369093 0.008917267 0.007611145
    ## 23 0.882906308 0.858261056 0.25499267 0.231587000 0.219598333
    ## 24 0.016530602 0.020687847 0.09676523 0.088797000 0.079679333
    ## 25 0.008474723 0.004557383 0.03359007 0.000000000 0.002858457
    ## 26 0.839407206 0.851032332 0.25848367 0.234341667 0.225393667
    ## 27 0.017126584 0.022093400 0.10204487 0.065762500 0.073185500
    ## 28 0.009096723 0.003765343 0.03049023 0.014580200 0.009898377
    ## 29 0.876109860 0.861161430 0.26524000 0.234206667 0.219176000
    ## 30 0.015991158 0.019371099 0.10004657 0.090089333 0.083200000
    ## 31 0.009465063 0.004966187 0.03385850 0.009582200 0.006155984
    ## 32 0.873616444 0.867452540 0.28691967 0.212230333 0.216322333
    ## 33 0.017186947 0.015829843 0.09951567 0.088623667 0.080974000
    ## 34 0.009176127 0.004794867 0.03613338 0.006787780 0.005484283
    ## 35 0.911103611 0.868935825 0.25316267 0.238156333 0.225460333
    ## 36 0.017237502 0.019414792 0.10504147 0.085474000 0.079448000
    ## 37 0.008115327 0.005356247 0.03131897 0.008530867 0.007539757
    ## 38 0.873036152 0.880604385 0.27391567 0.211873333 0.218347000
    ## 39 0.015134053 0.018771557 0.10538043 0.084228667 0.081903667

# PULSE EXPERIMENTS

## Estimation of KS

We calculate the average enrichment of free labelled alanine and serine
at ZT24 and then the *K*<sub>*S*</sub> - using Gaussian error
propagation (REF). Data table is cast back into wide format prior to
calculations.

``` r
ishihara_KS <- ishihara2017_summary %>%
  subset(time == 24) %>%
  mutate_with_error( SAt1t2 ~ (Free_Ala + Free_Ser) / 2 ) %>%  # calculate the correction factor
  mutate_with_error( KS_Ala ~ (Prot_Ala / SAt1t2) ) %>%        # calculate KS for Alanine
  mutate_with_error( KS_Ser ~ (Prot_Ser / SAt1t2) ) %>%        # calculate KS for Serine
  select(
    -all_of(c( # remove unwanted columns
      "time",
      c(vars_prot, vars_free, vars_glc, "SAt1t2"),
      paste0("d", c(vars_prot, vars_free, vars_glc, "SAt1t2"))
    ))
  )

ishihara_KS
```

    ##    Genotype    KS_Ala     dKS_Ala    KS_Ser     dKS_Ser
    ## 2      Ang0 0.2901297 0.014490779 0.2831006 0.006022329
    ## 5     Bsch2 0.2478679 0.010584508 0.2328115 0.007288489
    ## 8       Bu2 0.2693639 0.012789129 0.2542564 0.007877798
    ## 11     Col0 0.2594269 0.018875643 0.2647341 0.005419860
    ## 14      Cvi 0.2790553 0.016208761 0.2695254 0.011699278
    ## 17      Da0 0.2760931 0.010699489 0.2609760 0.008534873
    ## 20      Ei2 0.2224704 0.023873538 0.2382417 0.011341294
    ## 23      Kl0 0.2660135 0.014304106 0.2522426 0.009885593
    ## 26     Lip0 0.2772553 0.010900453 0.2666687 0.005567759
    ## 29      Mh1 0.2696259 0.004351441 0.2523221 0.003200148
    ## 32     Old1 0.2437931 0.017196542 0.2484937 0.005321389
    ## 35    Peter 0.2675855 0.006018278 0.2533206 0.003782189
    ## 38     RRS7 0.2416383 0.018210647 0.2490214 0.012668126

## Estimation of RGRSTR

Cases in which calculations involve comparisons between time points
demands reorganization of the data set we are using. Below we define a
logic to create a individual column for values of each time point. This
will be achieved by melting the original data set, renaming the variable
names (i.e. append the time to their names) and finally re-casting the
tidy data set into a wide data set; as follows:

``` r
ishihara_pulse_data <- ishihara2017_summary %>%
  subset(time %in% c(0, 24)) %>%
  melt(id.vars = vars_id) %>%
  mutate(variable = paste(variable, time, sep = "_")) %>%
  select(-time) %>%           # remove unwanted columns
  dcast(Genotype ~ variable)

ishihara_pulse_data
```

    ##    Genotype dFree_Ala_0 dFree_Ala_24 dFree_Ser_0 dFree_Ser_24      dGlc_0
    ## 1      Ang0 0.002126824   0.01048293 0.001426218  0.011058050 0.005299616
    ## 2     Bsch2 0.002695762   0.02044153 0.001333393  0.017225799 0.005818499
    ## 3       Bu2 0.002325720   0.03147734 0.001356079  0.016717538 0.003681750
    ## 4      Col0 0.001126388   0.01060446 0.002281206  0.006752922 0.004827112
    ## 5       Cvi 0.003833341   0.04245023 0.002722050  0.040193648 0.003533195
    ## 6       Da0 0.003171368   0.02489737 0.002753668  0.049629908 0.006598357
    ## 7       Ei2 0.002226488   0.02718531 0.002516555  0.018454254 0.004966955
    ## 8       Kl0 0.001976794   0.03119187 0.002125056  0.018088349 0.005806594
    ## 9      Lip0 0.002705954   0.03051726 0.001362854  0.015832671 0.006842885
    ## 10      Mh1 0.002702706   0.01306236 0.002733441  0.009836593 0.004325808
    ## 11     Old1 0.002032038   0.01128886 0.002493667  0.014742924 0.006423412
    ## 12    Peter 0.002403649   0.01851484 0.001828871  0.018955672 0.005188284
    ## 13     RRS7 0.002678887   0.02094184 0.001918678  0.017388048 0.004765221
    ##       dGlc_24 dProt_Ala_0 dProt_Ala_24  dProt_Ser_0 dProt_Ser_24  Free_Ala_0
    ## 1  0.02322525 0.003374540  0.011651814 0.0017214871 0.0044318631 0.009462740
    ## 2  0.01320393 0.003030798  0.008735140 0.0033503683 0.0056304478 0.007784377
    ## 3  0.02063305 0.006476477  0.009441511 0.0008735688 0.0046942183 0.007409200
    ## 4  0.01706044 0.004135325  0.015219434 0.0016434416 0.0040678176 0.009273507
    ## 5  0.01859113 0.005755947  0.009831289 0.0012569448 0.0047906729 0.008932330
    ## 6  0.01950308 0.003210396  0.005098036 0.0010666681 0.0011948206 0.007302007
    ## 7  0.03021185 0.004202170  0.020416905 0.0026342749 0.0090426647 0.009970023
    ## 8  0.02378980 0.004580700  0.011492392 0.0038898616 0.0073066272 0.008030447
    ## 9  0.02065301 0.000000000  0.007884777 0.0021325129 0.0010644312 0.008474723
    ## 10 0.01983424 0.002699894  0.003070414 0.0020504533 0.0018631249 0.009096723
    ## 11 0.02338232 0.005002250  0.014798081 0.0039058189 0.0040170839 0.009465063
    ## 12 0.01910530 0.003535399  0.004015300 0.0031388755 0.0002598348 0.009176127
    ## 13 0.02824934 0.004466206  0.015625132 0.0031028942 0.0105780023 0.008115327
    ##    Free_Ala_24  Free_Ser_0 Free_Ser_24      Glc_0    Glc_24  Prot_Ala_0
    ## 1    0.8092720 0.004770930   0.8275785 0.03205400 0.2636390 0.013619043
    ## 2    0.8890829 0.003791980   0.8761937 0.03397107 0.2789667 0.010103613
    ## 3    0.8234368 0.003936590   0.8329250 0.02914440 0.2593753 0.012865933
    ## 4    0.8163778 0.003588647   0.8054534 0.03755323 0.2542177 0.008070567
    ## 5    0.7840713 0.006480517   0.7921709 0.03227132 0.2460667 0.011169167
    ## 6    0.8821298 0.003269073   0.8386182 0.03302507 0.2621507 0.017047567
    ## 7    0.8609352 0.006907917   0.8766758 0.03180587 0.2561917 0.012837857
    ## 8    0.8829063 0.003790420   0.8582611 0.03369093 0.2549927 0.008917267
    ## 9    0.8394072 0.004557383   0.8510323 0.03359007 0.2584837 0.000000000
    ## 10   0.8761099 0.003765343   0.8611614 0.03049023 0.2652400 0.014580200
    ## 11   0.8736164 0.004966187   0.8674525 0.03385850 0.2869197 0.009582200
    ## 12   0.9111036 0.004794867   0.8689358 0.03613338 0.2531627 0.006787780
    ## 13   0.8730362 0.005356247   0.8806044 0.03131897 0.2739157 0.008530867
    ##    Prot_Ala_24  Prot_Ser_0 Prot_Ser_24
    ## 1    0.2374495 0.009270087   0.2316967
    ## 2    0.2187777 0.006760957   0.2054883
    ## 3    0.2230820 0.009391077   0.2105703
    ## 4    0.2103733 0.010000263   0.2146770
    ## 5    0.2199293 0.001799510   0.2124187
    ## 6    0.2375433 0.011475593   0.2245370
    ## 7    0.1932835 0.009345617   0.2069857
    ## 8    0.2315870 0.007611145   0.2195983
    ## 9    0.2343417 0.002858457   0.2253937
    ## 10   0.2342067 0.009898377   0.2191760
    ## 11   0.2122303 0.006155984   0.2163223
    ## 12   0.2381563 0.005484283   0.2254603
    ## 13   0.2118733 0.007539757   0.2183470

``` r
ishihara_RGRp <- ishihara_pulse_data %>%
  mutate_with_error( RGRp ~ Glc_24 - Glc_0 ) %>%
  select(c("Genotype", "RGRp", "dRGRp"))

ishihara_RGRp
```

    ##    Genotype      RGRp      dRGRp
    ## 1      Ang0 0.2315850 0.02382222
    ## 2     Bsch2 0.2449956 0.01442910
    ## 3       Bu2 0.2302309 0.02095896
    ## 4      Col0 0.2166644 0.01773019
    ## 5       Cvi 0.2137953 0.01892389
    ## 6       Da0 0.2291256 0.02058904
    ## 7       Ei2 0.2243858 0.03061742
    ## 8       Kl0 0.2213017 0.02448819
    ## 9      Lip0 0.2248936 0.02175711
    ## 10      Mh1 0.2347498 0.02030048
    ## 11     Old1 0.2530612 0.02424857
    ## 12    Peter 0.2170293 0.01979725
    ## 13     RRS7 0.2425967 0.02864843

## Estimation of KD

Calculation of *K*<sub>*d*<sub>*p*</sub></sub> can then be easily
achieved by joining the previously calculated datasets containing
*K*<sub>*s*</sub> and *R**G**R*<sub>*p*</sub><sup>*S**T**R*</sup>
results and apply the *K*<sub>*d*<sub>*p*</sub></sub> formula.

``` r
ishihara_KDp <- join(ishihara_KS, ishihara_RGRp, by = "Genotype") %>%
  mutate_with_error( KDp_Ala ~ KS_Ala - RGRp ) %>%
  mutate_with_error( KDp_Ser ~ KS_Ser - RGRp ) %>%
  select(c("Genotype", "KDp_Ala", "dKDp_Ala", "KDp_Ser", "dKDp_Ser"))

ishihara_KDp
```

    ##    Genotype       KDp_Ala   dKDp_Ala      KDp_Ser   dKDp_Ser
    ## 1      Ang0  0.0585447338 0.02788334  0.051515584 0.02457166
    ## 2     Bsch2  0.0028722567 0.01789499 -0.012184118 0.01616542
    ## 3       Bu2  0.0391329180 0.02455280  0.024025510 0.02239057
    ## 4      Col0  0.0427624941 0.02589690  0.048069664 0.01854007
    ## 5       Cvi  0.0652599154 0.02491661  0.055730077 0.02224830
    ## 6       Da0  0.0469675102 0.02320318  0.031850441 0.02228795
    ## 7       Ei2 -0.0019154039 0.03882489  0.013855867 0.03265044
    ## 8       Kl0  0.0447117525 0.02835981  0.030940915 0.02640826
    ## 9      Lip0  0.0523617070 0.02433499  0.041775111 0.02245822
    ## 10      Mh1  0.0348761323 0.02076161  0.017572368 0.02055117
    ## 11     Old1 -0.0092680313 0.02972733 -0.004567471 0.02482559
    ## 12    Peter  0.0505561741 0.02069180  0.036291322 0.02015529
    ## 13     RRS7 -0.0009584293 0.03394643  0.006424688 0.03132433

# CHASE EXPERIMENTS

``` r
ishihara_chase_data <- ishihara2017_summary %>%
  subset(time %in% c(24, 120)) %>%
  melt(id.vars = vars_id) %>%
  mutate(variable = paste(variable, time, sep = "_")) %>%
  select(-time) %>%           # remove unwanted columns
  dcast(Genotype ~ variable)

ishihara_chase_data
```

    ##    Genotype dFree_Ala_120 dFree_Ala_24 dFree_Ser_120 dFree_Ser_24    dGlc_120
    ## 1      Ang0   0.004990727   0.01048293   0.004530858  0.011058050 0.009765074
    ## 2     Bsch2   0.002869262   0.02044153   0.004681336  0.017225799 0.004073121
    ## 3       Bu2   0.003441396   0.03147734   0.003929320  0.016717538 0.005101506
    ## 4      Col0   0.002925453   0.01060446   0.004045988  0.006752922 0.006412159
    ## 5       Cvi   0.001827630   0.04245023   0.006964248  0.040193648 0.006617909
    ## 6       Da0   0.002575688   0.02489737   0.004514705  0.049629908 0.006714886
    ## 7       Ei2   0.003214255   0.02718531   0.004015927  0.018454254 0.005127667
    ## 8       Kl0   0.003588624   0.03119187   0.004287024  0.018088349 0.008522737
    ## 9      Lip0   0.004025762   0.03051726   0.002924188  0.015832671 0.005823850
    ## 10      Mh1   0.002834276   0.01306236   0.003546673  0.009836593 0.001459910
    ## 11     Old1   0.002482685   0.01128886   0.006172341  0.014742924 0.007784956
    ## 12    Peter   0.002721006   0.01851484   0.004071200  0.018955672 0.007016288
    ## 13     RRS7   0.004531040   0.02094184   0.004021764  0.017388048 0.005897806
    ##       dGlc_24 dProt_Ala_120 dProt_Ala_24 dProt_Ser_120 dProt_Ser_24
    ## 1  0.02322525  0.0136208625  0.011651814  0.0080657412 0.0044318631
    ## 2  0.01320393  0.0085570543  0.008735140  0.0024922948 0.0056304478
    ## 3  0.02063305  0.0063998949  0.009441511  0.0025022574 0.0046942183
    ## 4  0.01706044  0.0048597779  0.015219434  0.0020369607 0.0040678176
    ## 5  0.01859113  0.0029895713  0.009831289  0.0020182625 0.0047906729
    ## 6  0.01950308  0.0012310763  0.005098036  0.0020256206 0.0011948206
    ## 7  0.03021185  0.0025310959  0.020416905  0.0048448822 0.0090426647
    ## 8  0.02378980  0.0052151349  0.011492392  0.0004797521 0.0073066272
    ## 9  0.02065301  0.0098269446  0.007884777  0.0063470362 0.0010644312
    ## 10 0.01983424  0.0006541767  0.003070414  0.0025700763 0.0018631249
    ## 11 0.02338232  0.0012508408  0.014798081  0.0043583597 0.0040170839
    ## 12 0.01910530  0.0091971244  0.004015300  0.0077339376 0.0002598348
    ## 13 0.02824934  0.0063323256  0.015625132  0.0056974212 0.0105780023
    ##    Free_Ala_120 Free_Ala_24 Free_Ser_120 Free_Ser_24    Glc_120    Glc_24
    ## 1    0.01795434   0.8092720   0.02416673   0.8275785 0.10863353 0.2636390
    ## 2    0.01501821   0.8890829   0.01852524   0.8761937 0.10341253 0.2789667
    ## 3    0.01557824   0.8234368   0.01808161   0.8329250 0.09769370 0.2593753
    ## 4    0.01512074   0.8163778   0.01791289   0.8054534 0.10078663 0.2542177
    ## 5    0.01851670   0.7840713   0.02387593   0.7921709 0.10506427 0.2460667
    ## 6    0.01774933   0.8821298   0.02158789   0.8386182 0.10420687 0.2621507
    ## 7    0.01476542   0.8609352   0.01947080   0.8766758 0.10285327 0.2561917
    ## 8    0.01653060   0.8829063   0.02068785   0.8582611 0.09676523 0.2549927
    ## 9    0.01712658   0.8394072   0.02209340   0.8510323 0.10204487 0.2584837
    ## 10   0.01599116   0.8761099   0.01937110   0.8611614 0.10004657 0.2652400
    ## 11   0.01718695   0.8736164   0.01582984   0.8674525 0.09951567 0.2869197
    ## 12   0.01723750   0.9111036   0.01941479   0.8689358 0.10504147 0.2531627
    ## 13   0.01513405   0.8730362   0.01877156   0.8806044 0.10538043 0.2739157
    ##    Prot_Ala_120 Prot_Ala_24 Prot_Ser_120 Prot_Ser_24
    ## 1    0.08127467   0.2374495   0.08113433   0.2316967
    ## 2    0.07521367   0.2187777   0.07052667   0.2054883
    ## 3    0.08483100   0.2230820   0.07672033   0.2105703
    ## 4    0.08532133   0.2103733   0.07820833   0.2146770
    ## 5    0.08587767   0.2199293   0.07752567   0.2124187
    ## 6    0.08577367   0.2375433   0.07702400   0.2245370
    ## 7    0.08054800   0.1932835   0.07473633   0.2069857
    ## 8    0.08879700   0.2315870   0.07967933   0.2195983
    ## 9    0.06576250   0.2343417   0.07318550   0.2253937
    ## 10   0.09008933   0.2342067   0.08320000   0.2191760
    ## 11   0.08862367   0.2122303   0.08097400   0.2163223
    ## 12   0.08547400   0.2381563   0.07944800   0.2254603
    ## 13   0.08422867   0.2118733   0.08190367   0.2183470

## Estimation of KS

Note that results are in \#/day
:(120*h* − 24*h*) ÷ 24*h*/*d**a**y* = 4*d**a**y**s*; This value has to
be input as ‘numeric’ and not as an object given the behaviour of
`mutate_with_error()`. (This can be solved dynamically, to implement in
the future.)

``` r
# ishihara_KSloss <- ishihara_chase_data %>%
#   mutate_with_error( KSloss_Ala ~ (log(Prot_Ala_120) - log(Prot_Ala_24)) / (4) ) %>%
#   mutate_with_error( KSloss_Ser ~ (log(Prot_Ser_120) - log(Prot_Ser_24)) / (4) ) %>%
#   # remove unwanted columns
#   select(c("Genotype", "KSloss_Ala", "dKSloss_Ala", "KSloss_Ser", "dKSloss_Ser"))

ishihara_KSloss <- ishihara_chase_data %>%
  mutate_with_error( KSloss_Ala ~ -((log(Prot_Ala_120) - log(Prot_Ala_24))) / (4) ) %>%
  mutate_with_error( KSloss_Ser ~ -((log(Prot_Ser_120) - log(Prot_Ser_24))) / (4) ) %>%
  # remove unwanted columns
  select(c("Genotype", "KSloss_Ala", "dKSloss_Ala", "KSloss_Ser", "dKSloss_Ser"))

ishihara_KSloss
```

    ##    Genotype KSloss_Ala dKSloss_Ala KSloss_Ser dKSloss_Ser
    ## 1      Ang0  0.2680302 0.043656695  0.2623307 0.025308913
    ## 2     Bsch2  0.2669308 0.030143165  0.2673496 0.011179154
    ## 3       Bu2  0.2417196 0.021625894  0.2524132 0.009876521
    ## 4      Col0  0.2256148 0.023019090  0.2524396 0.008052197
    ## 5       Cvi  0.2350956 0.014164537  0.2519875 0.008610961
    ## 6       Da0  0.2546595 0.006454618  0.2674809 0.006707879
    ## 7       Ei2  0.2188262 0.027551694  0.2546708 0.019543288
    ## 8       Kl0  0.2396507 0.019222253  0.2534475 0.008453271
    ## 9      Lip0  0.3176826 0.038292997  0.2812128 0.021713452
    ## 10      Mh1  0.2388505 0.003746635  0.2421569 0.008009655
    ## 11     Old1  0.2183183 0.017785165  0.2456604 0.014234387
    ## 12    Peter  0.2561788 0.027228575  0.2607604 0.024338182
    ## 13     RRS7  0.2306133 0.026328162  0.2451354 0.021192475

## Estimation of RGRSTR

Similarly to what was done for the pulse data, the
*R**G**R*<sub>*c*</sub><sup>*S**T**R*</sup> calculation also demands
re-organization of the original dataset.

Note that results are in \#/day
:(120*h* − 24*h*) ÷ 24*h*/*d**a**y* = 4*d**a**y**s*; This value has to
be input as ‘numeric’ and not as an object given the behaviour of
`mutate_with_error()`.

``` r
ishihara_RGRc <- ishihara_chase_data %>%
  mutate_with_error( RGRc ~ 1 - (Glc_120 / Glc_24)^(1/4) ) %>% 
  select(c("Genotype", "RGRc", "dRGRc"))

ishihara_RGRc
```

    ##    Genotype      RGRc      dRGRc
    ## 1      Ang0 0.1988044 0.02520977
    ## 2     Bsch2 0.2197115 0.01201179
    ## 3       Bu2 0.2165984 0.01863659
    ## 4      Col0 0.2064957 0.01834452
    ## 5       Cvi 0.1916479 0.01987864
    ## 6       Da0 0.2059710 0.01953769
    ## 7       Ei2 0.2039996 0.02547835
    ## 8       Kl0 0.2151297 0.02517527
    ## 9      Lip0 0.2073353 0.01945792
    ## 10      Mh1 0.2163163 0.01492700
    ## 11     Old1 0.2325806 0.02167282
    ## 12    Peter 0.1974164 0.02022131
    ## 13     RRS7 0.2124361 0.02310295

## Estimation of KD

``` r
# ishihara_KDc <- join(ishihara_KSloss, ishihara_RGRc, by = "Genotype") %>%
#   mutate_with_error( KDc_Ala ~ -KSloss_Ala - RGRc ) %>%
#   mutate_with_error( KDc_Ser ~ -KSloss_Ser - RGRc ) %>%
#   select(c("Genotype", "KDc_Ala", "dKDc_Ala", "KDc_Ser", "dKDc_Ser"))

ishihara_KDc <- join(ishihara_KSloss, ishihara_RGRc, by = "Genotype") %>%
  mutate_with_error( KDc_Ala ~ KSloss_Ala - RGRc ) %>%
  mutate_with_error( KDc_Ser ~ KSloss_Ser - RGRc ) %>%
  select(c("Genotype", "KDc_Ala", "dKDc_Ala", "KDc_Ser", "dKDc_Ser"))

ishihara_KDc
```

    ##    Genotype     KDc_Ala   dKDc_Ala    KDc_Ser   dKDc_Ser
    ## 1      Ang0  0.06922576 0.05041269 0.06352632 0.03572217
    ## 2     Bsch2  0.04721928 0.03244832 0.04763811 0.01640904
    ## 3       Bu2  0.02512122 0.02854824 0.03581487 0.02109190
    ## 4      Col0  0.01911914 0.02943467 0.04594392 0.02003396
    ## 5       Cvi  0.04344770 0.02440890 0.06033961 0.02166354
    ## 6       Da0  0.04868847 0.02057628 0.06150982 0.02065712
    ## 7       Ei2  0.01482656 0.03752655 0.05067117 0.03211054
    ## 8       Kl0  0.02452102 0.03167474 0.03831780 0.02655658
    ## 9      Lip0  0.11034729 0.04295305 0.07387749 0.02915621
    ## 10      Mh1  0.02253420 0.01539002 0.02584059 0.01694019
    ## 11     Old1 -0.01426227 0.02803610 0.01307979 0.02592930
    ## 12    Peter  0.05876237 0.03391602 0.06334398 0.03164251
    ## 13     RRS7  0.01817718 0.03502739 0.03269930 0.03135071
